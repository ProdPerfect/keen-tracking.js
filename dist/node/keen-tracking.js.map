{"version":3,"sources":["webpack://Keen/webpack/bootstrap","webpack://Keen/./node_modules/keen-core/lib/utils/each.js","webpack://Keen/./lib/index.js","webpack://Keen/./node_modules/keen-core/lib/utils/extend.js","webpack://Keen/./lib/config-default.js","webpack://Keen/./node_modules/promise-polyfill/src/finally.js","webpack://Keen/./node_modules/promise-polyfill/src/index.js","webpack://Keen/./node_modules/promise-polyfill/src/polyfill.js","webpack://Keen/./lib/utils/queue.js","webpack://Keen/./lib/extend-events.js","webpack://Keen/./lib/utils/deepExtend.js","webpack://Keen/./lib/server.js","webpack://Keen/external \"keen-core\"","webpack://Keen/external \"component-emitter\"","webpack://Keen/./lib/record-events-server.js","webpack://Keen/./lib/utils/nodeRequestRetry.js","webpack://Keen/external \"http\"","webpack://Keen/external \"https\"","webpack://Keen/./lib/utils/unique.js","webpack://Keen/./lib/utils/md5.js","webpack://Keen/./lib/utils/cache-node.js","webpack://Keen/./lib/defer-events.js","webpack://Keen/./lib/helpers/getDatetimeIndex.js","webpack://Keen/./lib/helpers/getUniqueId.js","webpack://Keen/./lib/utils/timer.js"],"names":["KeenCore","helpers","on","client","extensions","events","collections","queue","config","recordDeferredEvents","prototype","writeKey","str","arguments","length","String","referrerPolicy","setGlobalProperties","props","log","configDefault","capacity","interval","retry","limit","initialDelay","retryOnResponseStatuses","unique","cache","dbName","dbCollectionName","dbCollectionKey","maxAge","configQueue","timer","check","shouldFlushQueue","flush","pause","emit","clearInterval","start","self","setInterval","extendEvent","eventCollection","eventModifier","handleValidationError","call","push","extendEvents","eventsModifier","message","getExtendedEventBody","result","i","modifierResult","deepExtend","target","Array","j","indexOf","prop","clone","undefined","input","JSON","parse","stringify","recordEvent","recordEvents","deferEvent","deferEvents","queueCapacity","queueInterval","getDatetimeIndex","getUniqueId","utils","version","pkg","Keen","KeenTracking","module","exports","eventCollectionOrConfigObject","eventBody","callback","configObject","clientConfig","collection","event","data","extendedEventBody","checkValidation","then","isUniqueResult","Promise","resolve","created","enabled","sendEventData","encodeURIComponent","eventsHash","extendedEventsHash","eventList","index","projectId","cb","err","path","eventData","urlPath","url","replace","protocol","host","method","headers","Buffer","byteLength","nodeRequestConfig","options","configRetry","retriesLimit","retryInitialDelay","retryOn","retriesCount","name","http","https","parseBody","responseBody","reject","response","error","e","error_code","Error","code","wrappedRequest","n","req","request","body","d","statusCode","parsedBody","write","end","setTimeout","uniqueIds","isUnique","customCacheConfig","configCache","stringifiedEvent","hashingMethod","hash","toLowerCase","expiryTime","Date","now","item","filter","alreadySentEvent","find","storage","MD5","M","V","Y","X","_","m","f","r","charCodeAt","charAt","fromCharCode","h","t","g","md5_ii","md5_hh","md5_gg","md5_ff","safe_add","md5_cmn","bit_rol","getFromCache","saveToCache","concat","num","Number","clonedQueueConfig","clonedQueueEvents","res","unloadDeferredEvents","date","getHours","parseInt","getDay","getDate","getMonth","getFullYear","crypto","getRandomValues","c","Uint8Array","toString","Math","random","v","count","value","clear"],"mappings":"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WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,kBAAkB;AAC/B;AACA,aAAa,kBAAkB;AAC/B;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA,+CAA+C,SAAS;AACxD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,+BAA+B,WAAc;;AAE7C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA,mBAAmB,iBAAiB;AACpC;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA,qCAAqC,SAAS;AAC9C;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;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","file":"node/keen-tracking.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n","module.exports = each;\n\nfunction each(o, cb, s){\n  var n;\n  if (!o){\n    return 0;\n  }\n  s = !s ? o : s;\n  if (o instanceof Array){\n    // Indexed arrays, needed for Safari\n    for (n=0; n<o.length; n++) {\n      if (cb.call(s, o[n], n, o) === false){\n        return 0;\n      }\n    }\n  } else {\n    // Hashtables\n    for (n in o){\n      if (o.hasOwnProperty(n)) {\n        if (cb.call(s, o[n], n, o) === false){\n          return 0;\n        }\n      }\n    }\n  }\n  return 1;\n}\n","import KeenCore from 'keen-core';\nimport each from 'keen-core/lib/utils/each';\nimport extend from 'keen-core/lib/utils/extend';\nimport { queue } from'./utils/queue';\n\nKeenCore.helpers = KeenCore.helpers || {};\n\n// Install internal queue\nKeenCore.on('client', function(client){\n  client.extensions = {\n    events: [],\n    collections: {}\n  };\n  client.queue = queue(client.config.queue);\n  client.queue.on('flush', function(){\n    client.recordDeferredEvents();\n  });\n});\n\n// Accessors\nKeenCore.prototype.writeKey = function(str){\n  if (!arguments.length) return this.config.writeKey;\n  this.config.writeKey = (str ? String(str) : null);\n  return this;\n};\n\nKeenCore.prototype.referrerPolicy = function(str){\n  if (!arguments.length) return this.config.referrerPolicy;\n  this.config.referrerPolicy = (str ? String(str) : null);\n  return this;\n};\n\n// DEPRECATED\nKeenCore.prototype.setGlobalProperties = function(props){\n  KeenCore.log('This method has been removed. Check out #extendEvents: https://github.com/keen/keen-tracking.js#extend-events');\n  return this;\n};\n\nexport default KeenCore;\n","module.exports = extend;\n\nfunction extend(target){\n  for (var i = 1; i < arguments.length; i++) {\n    for (var prop in arguments[i]){\n      target[prop] = arguments[i][prop];\n    }\n  }\n  return target;\n};\n","export const configDefault = {\n\n  // defer events - queue\n  // https://github.com/keen/keen-tracking.js/blob/master/docs/defer-events.md\n  queue: {\n    capacity: 5000,\n    interval: 15,\n  },\n\n  // connection problems - retry request\n  retry: {\n    limit: 10,\n    initialDelay: 200,\n    retryOnResponseStatuses: [\n      408,\n      500,\n      502,\n      503,\n      504\n    ]\n  },\n\n  unique: false, // record only unique events?\n  // if so - store unique events hashes to compare\n  cache: {\n    /*\n      storage: 'indexeddb', // uncomment for persistence\n    */\n    dbName: 'keenTracking', // indexedDB name\n    dbCollectionName: 'events',\n    dbCollectionKey: 'hash',\n\n    /*\n      hashingMethod: 'md5', // if undefined - store as stringified JSON\n    */\n    maxAge: 60 * 1000, // store for 1 minute\n  }\n}\n\nexport default configDefault;\n","/**\n * @this {Promise}\n */\nfunction finallyConstructor(callback) {\n  var constructor = this.constructor;\n  return this.then(\n    function(value) {\n      // @ts-ignore\n      return constructor.resolve(callback()).then(function() {\n        return value;\n      });\n    },\n    function(reason) {\n      // @ts-ignore\n      return constructor.resolve(callback()).then(function() {\n        // @ts-ignore\n        return constructor.reject(reason);\n      });\n    }\n  );\n}\n\nexport default finallyConstructor;\n","import promiseFinally from './finally';\n\n// Store setTimeout reference so promise-polyfill will be unaffected by\n// other code modifying setTimeout (like sinon.useFakeTimers())\nvar setTimeoutFunc = setTimeout;\n\nfunction isArray(x) {\n  return Boolean(x && typeof x.length !== 'undefined');\n}\n\nfunction noop() {}\n\n// Polyfill for Function.prototype.bind\nfunction bind(fn, thisArg) {\n  return function() {\n    fn.apply(thisArg, arguments);\n  };\n}\n\n/**\n * @constructor\n * @param {Function} fn\n */\nfunction Promise(fn) {\n  if (!(this instanceof Promise))\n    throw new TypeError('Promises must be constructed via new');\n  if (typeof fn !== 'function') throw new TypeError('not a function');\n  /** @type {!number} */\n  this._state = 0;\n  /** @type {!boolean} */\n  this._handled = false;\n  /** @type {Promise|undefined} */\n  this._value = undefined;\n  /** @type {!Array<!Function>} */\n  this._deferreds = [];\n\n  doResolve(fn, this);\n}\n\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (self._state === 0) {\n    self._deferreds.push(deferred);\n    return;\n  }\n  self._handled = true;\n  Promise._immediateFn(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n      return;\n    }\n    var ret;\n    try {\n      ret = cb(self._value);\n    } catch (e) {\n      reject(deferred.promise, e);\n      return;\n    }\n    resolve(deferred.promise, ret);\n  });\n}\n\nfunction resolve(self, newValue) {\n  try {\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    if (newValue === self)\n      throw new TypeError('A promise cannot be resolved with itself.');\n    if (\n      newValue &&\n      (typeof newValue === 'object' || typeof newValue === 'function')\n    ) {\n      var then = newValue.then;\n      if (newValue instanceof Promise) {\n        self._state = 3;\n        self._value = newValue;\n        finale(self);\n        return;\n      } else if (typeof then === 'function') {\n        doResolve(bind(then, newValue), self);\n        return;\n      }\n    }\n    self._state = 1;\n    self._value = newValue;\n    finale(self);\n  } catch (e) {\n    reject(self, e);\n  }\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction finale(self) {\n  if (self._state === 2 && self._deferreds.length === 0) {\n    Promise._immediateFn(function() {\n      if (!self._handled) {\n        Promise._unhandledRejectionFn(self._value);\n      }\n    });\n  }\n\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\n    handle(self, self._deferreds[i]);\n  }\n  self._deferreds = null;\n}\n\n/**\n * @constructor\n */\nfunction Handler(onFulfilled, onRejected, promise) {\n  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n  this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, self) {\n  var done = false;\n  try {\n    fn(\n      function(value) {\n        if (done) return;\n        done = true;\n        resolve(self, value);\n      },\n      function(reason) {\n        if (done) return;\n        done = true;\n        reject(self, reason);\n      }\n    );\n  } catch (ex) {\n    if (done) return;\n    done = true;\n    reject(self, ex);\n  }\n}\n\nPromise.prototype['catch'] = function(onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  // @ts-ignore\n  var prom = new this.constructor(noop);\n\n  handle(this, new Handler(onFulfilled, onRejected, prom));\n  return prom;\n};\n\nPromise.prototype['finally'] = promiseFinally;\n\nPromise.all = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!isArray(arr)) {\n      return reject(new TypeError('Promise.all accepts an array'));\n    }\n\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      try {\n        if (val && (typeof val === 'object' || typeof val === 'function')) {\n          var then = val.then;\n          if (typeof then === 'function') {\n            then.call(\n              val,\n              function(val) {\n                res(i, val);\n              },\n              reject\n            );\n            return;\n          }\n        }\n        args[i] = val;\n        if (--remaining === 0) {\n          resolve(args);\n        }\n      } catch (ex) {\n        reject(ex);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.resolve = function(value) {\n  if (value && typeof value === 'object' && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function(value) {\n  return new Promise(function(resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!isArray(arr)) {\n      return reject(new TypeError('Promise.race accepts an array'));\n    }\n\n    for (var i = 0, len = arr.length; i < len; i++) {\n      Promise.resolve(arr[i]).then(resolve, reject);\n    }\n  });\n};\n\n// Use polyfill for setImmediate for performance gains\nPromise._immediateFn =\n  // @ts-ignore\n  (typeof setImmediate === 'function' &&\n    function(fn) {\n      // @ts-ignore\n      setImmediate(fn);\n    }) ||\n  function(fn) {\n    setTimeoutFunc(fn, 0);\n  };\n\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n  if (typeof console !== 'undefined' && console) {\n    console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console\n  }\n};\n\nexport default Promise;\n","import Promise from './index';\nimport promiseFinally from './finally';\n\n/** @suppress {undefinedVars} */\nvar globalNS = (function() {\n  // the only reliable means to get the global object is\n  // `Function('return this')()`\n  // However, this causes CSP violations in Chrome apps.\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n  throw new Error('unable to locate global object');\n})();\n\nif (!('Promise' in globalNS)) {\n  globalNS['Promise'] = Promise;\n} else if (!globalNS.Promise.prototype['finally']) {\n  globalNS.Promise.prototype['finally'] = promiseFinally;\n}\n","import Emitter from 'component-emitter';\n\nimport configDefault from '../config-default.js';\n\nexport function queue(configQueue = {}) {\n  if (this instanceof queue === false) {\n    return new queue(configQueue);\n  }\n  this.capacity = 0;\n  this.config = {\n    ...configDefault.queue,\n    ...configQueue\n  };\n  this.events = {\n    // \"collection-1\": [],\n    // \"collection-2\": []\n  };\n  this.interval = 0;\n  this.timer = null;\n  return this;\n}\n\nEmitter(queue.prototype);\n\nqueue.prototype.check = function() {\n  if (shouldFlushQueue(this)) {\n    this.flush();\n  }\n  if (this.config.interval === 0 || this.capacity === 0) {\n    this.pause();\n  }\n  return this;\n};\n\nqueue.prototype.flush = function() {\n  this.emit('flush');\n  this.interval = 0;\n  return this;\n};\n\nqueue.prototype.pause = function() {\n  if (this.timer) {\n    clearInterval(this.timer);\n    this.timer = null;\n  }\n  return this;\n};\n\nqueue.prototype.start = function() {\n  var self = this;\n  self.pause();\n  self.timer = setInterval(function() {\n    self.interval++;\n    self.check();\n  }, 1000);\n  return self;\n};\n\nfunction shouldFlushQueue(props) {\n  if (props.capacity > 0 && props.interval >= props.config.interval) {\n    return true;\n  }\n  else if (props.capacity >= props.config.capacity) {\n    return true;\n  }\n  return false;\n}\n","import { deepExtend } from './utils/deepExtend';\nimport each from 'keen-core/lib/utils/each';\n\nexport function extendEvent(eventCollection, eventModifier){\n  if (arguments.length !== 2 || typeof eventCollection !== 'string'\n    || ('object' !== typeof eventModifier && 'function' !== typeof eventModifier)) {\n      handleValidationError.call(this, 'Incorrect arguments provided to #extendEvent method');\n      return;\n  }\n  this.extensions.collections[eventCollection] = this.extensions.collections[eventCollection] || [];\n  this.extensions.collections[eventCollection].push(eventModifier);\n  this.emit('extendEvent', eventCollection, eventModifier);\n  return this;\n}\n\nexport function extendEvents(eventsModifier){\n  if (arguments.length !== 1 || ('object' !== typeof eventsModifier && 'function' !== typeof eventsModifier)) {\n    handleValidationError.call(this, 'Incorrect arguments provided to #extendEvents method');\n    return;\n  }\n  this.extensions.events.push(eventsModifier);\n  this.emit('extendEvents', eventsModifier);\n  return this;\n}\n\nfunction handleValidationError(message){\n  this.emit('error', `Event(s) not extended: ${message}`);\n}\n\nexport function getExtendedEventBody(result, queue){\n  if (queue && queue.length > 0) {\n    each(queue, function(eventModifier, i){\n      let modifierResult = (typeof eventModifier === 'function') ? eventModifier() : eventModifier;\n      deepExtend(result, modifierResult);\n    });\n  }\n  return result;\n}\n","export const deepExtend = function(target){\n  for (var i = 1; i < arguments.length; i++) {\n    // Copy unique items from incoming array\n    if (target instanceof Array && arguments[i] instanceof Array) {\n      for (var j = 0; j < arguments[i].length; j++) {\n        if (target.indexOf(arguments[i][j]) < 0) {\n          target.push(arguments[i][j]);\n        }\n      }\n    }\n    // Blend objects\n    else {\n      for (var prop in arguments[i]){\n        // Recurse when both contain objects of same name\n        // and incoming is not a null object\n        if (typeof target[prop] !== 'undefined'\n          && typeof arguments[i][prop] === 'object'\n          && arguments[i][prop] !== null) {\n            deepExtend(target[prop], clone(arguments[i][prop]));\n        }\n        // Otherwise just copy it over...\n        else if (\n          arguments[i][prop] !== undefined &&\n          typeof arguments[i][prop] !== 'function') {\n            target[prop] = clone(arguments[i][prop]);\n        }\n      }\n    }\n  }\n  return target;\n}\n\nfunction clone(input){\n  return JSON.parse( JSON.stringify(input) );\n}\n","import KeenCore from './index';\nimport extend from 'keen-core/lib/utils/extend';\nimport {\n  recordEvent,\n  recordEvents\n} from './record-events-server';\nimport {\n  deferEvent,\n  deferEvents,\n  queueCapacity,\n  queueInterval,\n  recordDeferredEvents\n} from './defer-events';\nimport { extendEvent, extendEvents } from './extend-events';\nimport { getDatetimeIndex } from './helpers/getDatetimeIndex';\nimport { getUniqueId } from './helpers/getUniqueId';\nimport { deepExtend } from './utils/deepExtend';\nimport { timer } from './utils/timer';\nimport pkg from '../package.json';\n\n// ------------------------\n// Methods\n// ------------------------\nextend(KeenCore.prototype, {\n  recordEvent,\n  recordEvents\n});\nextend(KeenCore.prototype, {\n  deferEvent,\n  deferEvents,\n  queueCapacity,\n  queueInterval,\n  recordDeferredEvents\n});\nextend(KeenCore.prototype, {\n  extendEvent,\n  extendEvents\n});\n\n// ------------------------\n// Helpers\n// ------------------------\nextend(KeenCore.helpers, {\n  getDatetimeIndex,\n  getUniqueId\n});\n\n// ------------------------\n// Utils\n// ------------------------\nextend(KeenCore.utils, {\n  deepExtend,\n  timer\n});\n\nKeenCore.version = pkg.version;\n\nexport const Keen = KeenCore; // deprecated, left for backward compatibility\nexport const KeenTracking = KeenCore;\nmodule.exports = Keen;\n","module.exports = keen-core;","module.exports = component-emitter;","import 'promise-polyfill/src/polyfill';\n\nimport Keen from './index';\nimport each from 'keen-core/lib/utils/each';\nimport extend from 'keen-core/lib/utils/extend';\nimport { getExtendedEventBody } from './extend-events';\n\nimport nodeRequestRetry from './utils/nodeRequestRetry';\nimport isUnique from './utils/unique';\n\n// ------------------------------\n// .recordEvent\n// ------------------------------\n\nexport function recordEvent(eventCollectionOrConfigObject, eventBody, callback){\n  let eventCollection = eventCollectionOrConfigObject;\n  let unique;\n  let configObject;\n  let clientConfig = this.config;\n\n  if (typeof eventCollectionOrConfigObject === 'object'\n    && eventCollectionOrConfigObject) {\n    // slowly but surely we migrate to one object with all args\n    configObject = eventCollectionOrConfigObject;\n    eventCollection = eventCollectionOrConfigObject.collection;\n    eventBody = eventCollectionOrConfigObject.event;\n    callback = eventCollectionOrConfigObject.callback;\n    unique = eventCollectionOrConfigObject.unique;\n  }\n\n  let data = {};\n  let extendedEventBody = {};\n\n  if (!checkValidation.call(this, callback)) {\n    return;\n  }\n\n  if (!eventCollection || typeof eventCollection !== 'string') {\n    handleValidationError.call(this, 'Collection name must be a string.', callback);\n    return;\n  }\n\n  extend(data, eventBody);\n\n  // ------------------------------\n  // Run extendEvent(s) transforms\n  // ------------------------------\n\n  getExtendedEventBody(extendedEventBody, this.extensions.events);\n  getExtendedEventBody(extendedEventBody, this.extensions.collections[eventCollection]);\n  getExtendedEventBody(extendedEventBody, [data]);\n\n  if (unique) {\n    return isUnique(configObject, extendedEventBody).then(isUniqueResult => {\n      if (!isUniqueResult) {\n        return Promise.resolve({\n          created: false,\n          message: '[NOT_UNIQUE] This event has already been recorded'\n        });\n      }\n      return recordEvent.call(this, { ...eventCollectionOrConfigObject, unique: undefined });\n    });\n  }\n\n  this.emit('recordEvent', eventCollection, extendedEventBody);\n\n  if (!Keen.enabled) {\n    handleValidationError.call(this, 'Keen.enabled is set to false.', callback);\n    return false;\n  }\n\n  return sendEventData.call(this, encodeURIComponent(eventCollection), extendedEventBody, callback);\n}\n\n\n\n// ------------------------------\n// .recordEvents\n// ------------------------------\n\nexport function recordEvents(eventsHash, callback){\n  const self = this;\n  let extendedEventsHash = {};\n\n  if (!checkValidation.call(this, callback)) {\n    return;\n  }\n\n  if (arguments.length > 2) {\n    handleValidationError.call(this, 'Incorrect arguments provided to #recordEvents method', callback);\n    return;\n  }\n\n  // ------------------------------\n  // Run extendEvent(s) transforms\n  // ------------------------------\n  each(eventsHash, function(eventList, eventCollection){\n    // Find or create collection on new hash\n    extendedEventsHash[eventCollection] = extendedEventsHash[eventCollection] || [];\n    // Loop over each eventBody in the existing hash\n    each(eventList, function(eventBody, index){\n      // Create a new data object\n      var extendedEventBody = {};\n      // Process \"events\" transform pipeline\n      getExtendedEventBody(extendedEventBody, self.extensions.events);\n      // Process \"collection\" transform pipeline\n      getExtendedEventBody(extendedEventBody, self.extensions.collections[eventCollection]);\n      // Blend existing eventBody data into the result\n      getExtendedEventBody(extendedEventBody, [eventBody]);\n      // Push extendedEventBody into new hash\n      extendedEventsHash[eventCollection].push(extendedEventBody);\n    });\n  });\n\n  this.emit('recordEvents', extendedEventsHash);\n\n  if (!Keen.enabled) {\n    handleValidationError.call(this, 'Keen.enabled is set to false.', callback);\n    return false;\n  }\n\n  return sendEventData.call(this, undefined, extendedEventsHash, callback);\n}\n\n// ------------------------------\n// Validation\n// ------------------------------\n\nfunction checkValidation(callback){\n  if (!this.projectId()) {\n    handleValidationError.call(this, 'Keen.Client is missing a projectId property.', callback);\n    return false;\n  }\n  if (!this.writeKey()) {\n    handleValidationError.call(this, 'Keen.Client is missing a writeKey property.', callback);\n    return false;\n  }\n  return true;\n}\n\nfunction handleValidationError(message, cb){\n  const err = 'Event(s) not recorded: ' + message;\n  this.emit('error', err);\n  if (cb) {\n    cb.call(this, err, null);\n  }\n}\n\nfunction sendEventData(path, eventData, callback){\n  const data = JSON.stringify(eventData);\n\n  let urlPath = this.url('events', path)\n    .replace(this.config.protocol + '://' + this.config.host, '');\n\n  const config = {\n    host: this.config.host,\n    path: urlPath,\n    method: 'POST',\n    headers: {\n      'Authorization': this.writeKey(),\n      'Content-Type': 'application/json',\n      'Content-Length': Buffer.byteLength(data)\n    },\n    ...this.config.nodeRequestConfig\n  };\n\n  return nodeRequestRetry({\n    retry: this.config.retry,\n    protocol: this.config.protocol,\n    config,\n    data,\n    callback\n  });\n}\n","import 'promise-polyfill/src/polyfill';\n\nimport http from 'http';\nimport https from 'https';\n\nimport configDefault from '../config-default.js';\n\nexport default function(options) {\n\n  const configRetry = {\n    ...configDefault.retry,\n    ...(options.retry || {})\n  };\n\n  const retriesLimit = configRetry.limit;\n  const retryInitialDelay = configRetry.initialDelay;\n  const retryOn = configRetry.retryOnResponseStatuses;\n  const { callback } = options;\n  let retriesCount = 0;\n\n  if (retryOn && !(retryOn instanceof Array)) {\n    throw {\n      name: 'ArgumentError',\n      message: 'retryOn property expects an array'\n    }\n  }\n\n  const protocol = (options.protocol === 'http') ? http : https;\n\n  const parseBody = (responseBody) => {\n    return new Promise((resolve, reject) => {\n      let response;\n      let error;\n      try {\n        response = JSON.parse(responseBody);\n      }\n      catch (e) {\n        // Parsing Error\n        error = e;\n      }\n      if (!error && response.error_code) {\n        // API Error\n        error = new Error(response.message || 'Unknown error occurred');\n        error.code = response.error_code;\n        reject(error);\n      }\n      resolve(response);\n    });\n  };\n\n  return new Promise((resolve, reject) => {\n    const wrappedRequest = (n) => {\n      let req = protocol.request(options.config, (response) => {\n        let body = '';\n        response.on('data', (d)  => {\n          body += d;\n        });\n        response.on('end', ()  => {\n          if (retryOn.indexOf(response.statusCode) === -1) {\n            parseBody(body).then(parsedBody => {\n              resolve(parsedBody);\n              if (callback) callback(null, parsedBody);\n            }).catch(err => {\n              reject(err);\n              if (callback) callback(err, null);\n            });\n          } else {\n            if (n > 0) {\n              retry();\n            } else {\n              if (callback) callback(body, null);\n              reject(body);\n            }\n          }\n        });\n      });\n      req.on('error', (err) => {\n        if (n > 0) {\n          retry();\n        } else {\n          if (callback) callback(body, null);\n          reject(err);\n        }\n      });\n      req.write(options.data);\n      req.end();\n    };\n\n    function retry() {\n      retriesCount = retriesCount + 1;\n      setTimeout(function() {\n          wrappedRequest(retriesLimit - retriesCount);\n        }, 2^retriesCount * retryInitialDelay);\n    }\n\n    wrappedRequest(retriesLimit - retriesCount);\n  });\n};\n","module.exports = require(\"http\");","module.exports = require(\"https\");","import 'promise-polyfill/src/polyfill';\n\nimport md5 from './md5';\nimport { getFromCache, saveToCache } from './cache-browser';\n\nimport configDefault from '../config-default.js';\n\nlet uniqueIds = [];\n\nexport const isUnique = (customCacheConfig, extendedEventBody) => {\n  const configCache = { ...configDefault.cache, ...customCacheConfig.cache };\n  const stringifiedEvent = JSON.stringify(extendedEventBody);\n  const { hashingMethod } = configCache;\n  const hash = hashingMethod && hashingMethod.toLowerCase() === 'md5'\n    ? md5(stringifiedEvent) : stringifiedEvent;\n  const expiryTime = configCache.maxAge ? (Date.now() + configCache.maxAge) : undefined;\n  const item = {\n    hash,\n    expiryTime\n  };\n  if (expiryTime){\n    const now = Date.now();\n    uniqueIds = uniqueIds.filter(item => item.expiryTime > now);\n  }\n\n  const alreadySentEvent = uniqueIds.find(item => item.hash === hash);\n  if (alreadySentEvent) {\n    if (alreadySentEvent.expiryTime && alreadySentEvent.expiryTime < Date.now()) {\n      uniqueIds = uniqueIds.filter(item => item.hash !== hash);\n    } else {\n      return Promise.resolve(false);\n    }\n  }\n  uniqueIds.push(item);\n  if (configCache.storage && configCache.storage.toLowerCase() === 'indexeddb') {\n    return getFromCache(hash, configCache).then(alreadySentEvent => {\n      if (alreadySentEvent) {\n        return false;\n      }\n      saveToCache(hash, configCache);\n      return true;\n    });\n  }\n\n  return Promise.resolve(true);\n}\n\nexport default isUnique;\n","export const MD5 = function(d){const result = M(V(Y(X(d),8*d.length)));return result.toLowerCase()};function M(d){for(var _,m=\"0123456789ABCDEF\",f=\"\",r=0;r<d.length;r++)_=d.charCodeAt(r),f+=m.charAt(_>>>4&15)+m.charAt(15&_);return f}function X(d){for(var _=Array(d.length>>2),m=0;m<_.length;m++)_[m]=0;for(m=0;m<8*d.length;m+=8)_[m>>5]|=(255&d.charCodeAt(m/8))<<m%32;return _}function V(d){for(var _=\"\",m=0;m<32*d.length;m+=8)_+=String.fromCharCode(d[m>>5]>>>m%32&255);return _}function Y(d,_){d[_>>5]|=128<<_%32,d[14+(_+64>>>9<<4)]=_;for(var m=1732584193,f=-271733879,r=-1732584194,i=271733878,n=0;n<d.length;n+=16){var h=m,t=f,g=r,e=i;f=md5_ii(f=md5_ii(f=md5_ii(f=md5_ii(f=md5_hh(f=md5_hh(f=md5_hh(f=md5_hh(f=md5_gg(f=md5_gg(f=md5_gg(f=md5_gg(f=md5_ff(f=md5_ff(f=md5_ff(f=md5_ff(f,r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+0],7,-680876936),f,r,d[n+1],12,-389564586),m,f,d[n+2],17,606105819),i,m,d[n+3],22,-1044525330),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+4],7,-176418897),f,r,d[n+5],12,1200080426),m,f,d[n+6],17,-1473231341),i,m,d[n+7],22,-45705983),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+8],7,1770035416),f,r,d[n+9],12,-1958414417),m,f,d[n+10],17,-42063),i,m,d[n+11],22,-1990404162),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+12],7,1804603682),f,r,d[n+13],12,-40341101),m,f,d[n+14],17,-1502002290),i,m,d[n+15],22,1236535329),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+1],5,-165796510),f,r,d[n+6],9,-1069501632),m,f,d[n+11],14,643717713),i,m,d[n+0],20,-373897302),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+5],5,-701558691),f,r,d[n+10],9,38016083),m,f,d[n+15],14,-660478335),i,m,d[n+4],20,-405537848),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+9],5,568446438),f,r,d[n+14],9,-1019803690),m,f,d[n+3],14,-187363961),i,m,d[n+8],20,1163531501),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+13],5,-1444681467),f,r,d[n+2],9,-51403784),m,f,d[n+7],14,1735328473),i,m,d[n+12],20,-1926607734),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+5],4,-378558),f,r,d[n+8],11,-2022574463),m,f,d[n+11],16,1839030562),i,m,d[n+14],23,-35309556),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+1],4,-1530992060),f,r,d[n+4],11,1272893353),m,f,d[n+7],16,-155497632),i,m,d[n+10],23,-1094730640),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+13],4,681279174),f,r,d[n+0],11,-358537222),m,f,d[n+3],16,-722521979),i,m,d[n+6],23,76029189),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+9],4,-640364487),f,r,d[n+12],11,-421815835),m,f,d[n+15],16,530742520),i,m,d[n+2],23,-995338651),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+0],6,-198630844),f,r,d[n+7],10,1126891415),m,f,d[n+14],15,-1416354905),i,m,d[n+5],21,-57434055),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+12],6,1700485571),f,r,d[n+3],10,-1894986606),m,f,d[n+10],15,-1051523),i,m,d[n+1],21,-2054922799),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+8],6,1873313359),f,r,d[n+15],10,-30611744),m,f,d[n+6],15,-1560198380),i,m,d[n+13],21,1309151649),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+4],6,-145523070),f,r,d[n+11],10,-1120210379),m,f,d[n+2],15,718787259),i,m,d[n+9],21,-343485551),m=safe_add(m,h),f=safe_add(f,t),r=safe_add(r,g),i=safe_add(i,e)}return Array(m,f,r,i)}function md5_cmn(d,_,m,f,r,i){return safe_add(bit_rol(safe_add(safe_add(_,d),safe_add(f,i)),r),m)}function md5_ff(d,_,m,f,r,i,n){return md5_cmn(_&m|~_&f,d,_,r,i,n)}function md5_gg(d,_,m,f,r,i,n){return md5_cmn(_&f|m&~f,d,_,r,i,n)}function md5_hh(d,_,m,f,r,i,n){return md5_cmn(_^m^f,d,_,r,i,n)}function md5_ii(d,_,m,f,r,i,n){return md5_cmn(m^(_|~f),d,_,r,i,n)}function safe_add(d,_){var m=(65535&d)+(65535&_);return(d>>16)+(_>>16)+(m>>16)<<16|65535&m}function bit_rol(d,_){return d<<_|d>>>32-_}\n\nexport default MD5;\n","// placeholder for future implementation\nmodule.exports = {\n  getFromCache: () => {},\n  saveToCache: () => {}\n}\n","import Keen from './index';\nimport each from 'keen-core/lib/utils/each';\nimport { queue } from './utils/queue';\n\nexport function deferEvent(eventCollection, eventBody){\n\n  if (arguments.length !== 2 || typeof eventCollection !== 'string') {\n    handleValidationError.call(this, 'Incorrect arguments provided to #deferEvent method');\n    return;\n  }\n\n  this.queue.events[eventCollection] = this.queue.events[eventCollection] || [];\n  this.queue.events[eventCollection].push(eventBody);\n  this.queue.capacity++;\n  if (!this.queue.timer) {\n    this.queue.start();\n  }\n  this.emit('deferEvent', eventCollection, eventBody);\n  return this;\n}\n\nexport function deferEvents(eventsHash){\n  var self = this;\n\n  if (arguments.length !== 1 || typeof eventsHash !== 'object') {\n    handleValidationError.call(this, 'Incorrect arguments provided to #deferEvents method');\n    return;\n  }\n\n  each(eventsHash, function(eventList, eventCollection){\n    self.queue.events[eventCollection] = self.queue.events[eventCollection] || [];\n    self.queue.events[eventCollection] = self.queue.events[eventCollection].concat(eventList);\n    self.queue.capacity = self.queue.capacity + eventList.length;\n    if (!self.queue.timer) {\n      self.queue.start();\n    }\n  });\n  self.emit('deferEvents', eventsHash);\n  return self;\n}\n\nexport function queueCapacity(num){\n  if (!arguments.length) return this.queue.config.capacity;\n  this.queue.config.capacity = num ? Number(num): 0;\n  this.queue.check();\n  return this;\n}\n\nexport function queueInterval(num){\n  if (!arguments.length) return this.queue.config.interval;\n  this.queue.config.interval = num ? Number(num): 0;\n  this.queue.check();\n  return this;\n}\n\nexport function recordDeferredEvents(){\n  const self = this;\n\n  if (self.queue.capacity > 0) {\n    self.queue.pause();\n    let clonedQueueConfig = { ...self.queue.config };\n    let clonedQueueEvents = { ...self.queue.events };\n    self.queue = queue();\n    self.queue.config = clonedQueueConfig;\n    self.queue.on('flush', function(){\n      self.recordDeferredEvents();\n    });\n    self.emit('recordDeferredEvents', clonedQueueEvents);\n    self.recordEvents(clonedQueueEvents, (err, res) => {\n      if (err) {\n        self.emit('recordDeferredEventsError', err, clonedQueueEvents);\n      }\n    });\n  }\n  return self;\n}\n\nexport function unloadDeferredEvents(){\n  self.queue.pause();\n  each(self.queue.events, function(events, collection){\n    self.recordEvent(collection, events);\n  });\n}\n\nfunction handleValidationError(message){\n  this.emit('error', `Event(s) not deferred: ${message}`);\n}\n","export function getDatetimeIndex(input){\n  var date = input || new Date();\n  return {\n    'hour_of_day'  : date.getHours(),\n    'day_of_week'  : parseInt( 1 + date.getDay() ),\n    'day_of_month' : date.getDate(),\n    'month'        : parseInt( 1 + date.getMonth() ),\n    'year'         : date.getFullYear()\n  };\n}\n","export function getUniqueId() {\n  // uuidv4\n  if (typeof crypto !== 'undefined' && crypto.getRandomValues) {\n    // browser\n    return ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>\n      (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)\n    )\n  } else {\n    // node & older browsers\n    let str = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx';\n    return str.replace(/[xy]/g, function(c) {\n      let r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);\n      return v.toString(16);\n    });\n  }\n}\n","export function timer(num){\n  if (this instanceof timer === false) {\n    return new timer(num);\n  }\n  this.count = num || 0;\n  return this;\n}\n\ntimer.prototype.start = function(){\n  var self = this;\n  this.pause();\n  this.interval = setInterval(function(){\n    self.count++;\n  }, 1000);\n  return this;\n};\n\ntimer.prototype.pause = function(){\n  clearInterval(this.interval);\n  return this;\n};\n\ntimer.prototype.value = function(){\n  return this.count;\n};\n\ntimer.prototype.clear = function(){\n  this.count = 0;\n  return this;\n};\n"],"sourceRoot":""}
