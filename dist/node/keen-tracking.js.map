{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./node_modules/keen-core/lib/utils/each.js","webpack:///./node_modules/keen-core/lib/utils/extend.js","webpack:///./lib/index.js","webpack:///./lib/utils/deepExtend.js","webpack:///./lib/extend-events.js","webpack:///./lib/utils/queue.js","webpack:///./lib/utils/timer.js","webpack:///./lib/helpers/getUniqueId.js","webpack:///./lib/helpers/getDatetimeIndex.js","webpack:///./lib/defer-events.js","webpack:///external \"https\"","webpack:///external \"http\"","webpack:///./lib/record-events-server.js","webpack:///external \"component-emitter\"","webpack:///external \"keen-core\"","webpack:///./lib/server.js"],"names":["KeenCore","helpers","on","client","extensions","events","collections","queue","recordDeferredEvents","prototype","writeKey","str","arguments","length","config","String","setGlobalProperties","props","log","emit","globalProperties","deepExtend","target","i","Array","j","indexOf","push","prop","clone","undefined","input","JSON","parse","stringify","extendEvent","extendEvents","getExtendedEventBody","eventCollection","eventModifier","handleValidationError","call","eventsModifier","message","err","result","modifierResult","capacity","interval","timer","check","shouldFlushQueue","flush","pause","clearInterval","start","self","setInterval","num","count","value","clear","getUniqueId","replace","c","r","Math","random","v","toString","getDatetimeIndex","date","Date","getHours","parseInt","getDay","getDate","getMonth","getFullYear","deferEvent","deferEvents","queueCapacity","queueInterval","eventBody","eventsHash","eventList","concat","Number","clonedQueueConfig","clonedQueueEvents","recordEvents","res","recordEvent","addEvent","addEvents","callback","url","data","cb","extendedEventBody","checkValidation","Keen","enabled","sendEventData","encodeURIComponent","extendedEventsHash","collection","body","index","modified","apply","projectId","path","eventData","protocol","host","options","method","headers","Buffer","byteLength","http","https","req","request","response","d","error","e","error_code","Error","code","write","end","utils","version","pkg","module","exports"],"mappings":"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","file":"node/keen-tracking.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"component-emitter\"), require(\"keen-core\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"component-emitter\", \"keen-core\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"component-emitter\"), require(\"keen-core\")) : factory(root[\"component-emitter\"], root[\"keen-core\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(global, function(__WEBPACK_EXTERNAL_MODULE__14__, __WEBPACK_EXTERNAL_MODULE__15__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 16);\n","module.exports = each;\n\nfunction each(o, cb, s){\n  var n;\n  if (!o){\n    return 0;\n  }\n  s = !s ? o : s;\n  if (o instanceof Array){\n    // Indexed arrays, needed for Safari\n    for (n=0; n<o.length; n++) {\n      if (cb.call(s, o[n], n, o) === false){\n        return 0;\n      }\n    }\n  } else {\n    // Hashtables\n    for (n in o){\n      if (o.hasOwnProperty(n)) {\n        if (cb.call(s, o[n], n, o) === false){\n          return 0;\n        }\n      }\n    }\n  }\n  return 1;\n}\n","module.exports = extend;\n\nfunction extend(target){\n  for (var i = 1; i < arguments.length; i++) {\n    for (var prop in arguments[i]){\n      target[prop] = arguments[i][prop];\n    }\n  }\n  return target;\n};\n","import KeenCore from 'keen-core';\nimport each from 'keen-core/lib/utils/each';\nimport extend from 'keen-core/lib/utils/extend';\nimport { queue } from'./utils/queue';\n\nKeenCore.helpers = KeenCore.helpers || {};\n\n// Install internal queue\nKeenCore.on('client', function(client){\n  client.extensions = {\n    events: [],\n    collections: {}\n  };\n  client.queue = queue();\n  client.queue.on('flush', function(){\n    client.recordDeferredEvents();\n  });\n});\n\n// Accessors\nKeenCore.prototype.writeKey = function(str){\n  if (!arguments.length) return this.config.writeKey;\n  this.config.writeKey = (str ? String(str) : null);\n  return this;\n};\n\n// DEPRECATED\nKeenCore.prototype.setGlobalProperties = function(props){\n  KeenCore.log('This method has been deprecated. Check out #extendEvents: https://github.com/keen/keen-tracking.js#extend-events');\n  if (!props || typeof props !== 'function') {\n    this.emit('error', 'Invalid value for global properties: ' + props);\n    return;\n  }\n  this.config.globalProperties = props;\n  return this;\n};\n\nexport default KeenCore;\n","export const deepExtend = function(target){\n  for (var i = 1; i < arguments.length; i++) {\n    // Copy unique items from incoming array\n    if (target instanceof Array && arguments[i] instanceof Array) {\n      for (var j = 0; j < arguments[i].length; j++) {\n        if (target.indexOf(arguments[i][j]) < 0) {\n          target.push(arguments[i][j]);\n        }\n      }\n    }\n    // Blend objects\n    else {\n      for (var prop in arguments[i]){\n        // Recurse when both contain objects of same name\n        // and incoming is not a null object\n        if (typeof target[prop] !== 'undefined'\n          && typeof arguments[i][prop] === 'object'\n          && arguments[i][prop] !== null) {\n            deepExtend(target[prop], clone(arguments[i][prop]));\n        }\n        // Otherwise just copy it over...\n        else if (\n          arguments[i][prop] !== undefined &&\n          typeof arguments[i][prop] !== 'function') {\n            target[prop] = clone(arguments[i][prop]);\n        }\n      }\n    }\n  }\n  return target;\n}\n\nfunction clone(input){\n  return JSON.parse( JSON.stringify(input) );\n}\n","import { deepExtend } from './utils/deepExtend';\nimport each from 'keen-core/lib/utils/each';\n\nexport function extendEvent(eventCollection, eventModifier){\n  if (arguments.length !== 2 || typeof eventCollection !== 'string'\n    || ('object' !== typeof eventModifier && 'function' !== typeof eventModifier)) {\n      handleValidationError.call(this, 'Incorrect arguments provided to #extendEvent method');\n      return;\n  }\n  this.extensions.collections[eventCollection] = this.extensions.collections[eventCollection] || [];\n  this.extensions.collections[eventCollection].push(eventModifier);\n  this.emit('extendEvent', eventCollection, eventModifier);\n  return this;\n}\n\nexport function extendEvents(eventsModifier){\n  if (arguments.length !== 1 || ('object' !== typeof eventsModifier && 'function' !== typeof eventsModifier)) {\n    handleValidationError.call(this, 'Incorrect arguments provided to #extendEvents method');\n    return;\n  }\n  this.extensions.events.push(eventsModifier);\n  this.emit('extendEvents', eventsModifier);\n  return this;\n}\n\nfunction handleValidationError(message){\n  var err = 'Event(s) not extended: ' + message;\n  this.emit('error', err);\n}\n\nexport function getExtendedEventBody(result, queue){\n  if (queue && queue.length > 0) {\n    each(queue, function(eventModifier, i){\n      var modifierResult = (typeof eventModifier === 'function') ? eventModifier() : eventModifier;\n      deepExtend(result, modifierResult);\n    });\n  }\n  return result;\n}\n","import Emitter from 'component-emitter';\n\nexport function queue() {\n  if (this instanceof queue === false) {\n    return new queue();\n  }\n  this.capacity = 0;\n  this.config = {\n    capacity: 5000,\n    interval: 15\n  };\n  this.events = {\n    // \"collection-1\": [],\n    // \"collection-2\": []\n  };\n  this.interval = 0;\n  this.timer = null;\n  return this;\n}\n\nEmitter(queue.prototype);\n\nqueue.prototype.check = function() {\n  if (shouldFlushQueue(this)) {\n    this.flush();\n  }\n  if (this.config.interval === 0 || this.capacity === 0) {\n    this.pause();\n  }\n  return this;\n};\n\nqueue.prototype.flush = function() {\n  this.emit('flush');\n  this.interval = 0;\n  return this;\n};\n\nqueue.prototype.pause = function() {\n  if (this.timer) {\n    clearInterval(this.timer);\n    this.timer = null;\n  }\n  return this;\n};\n\nqueue.prototype.start = function() {\n  var self = this;\n  self.pause();\n  self.timer = setInterval(function() {\n    self.interval++;\n    self.check();\n  }, 1000);\n  return self;\n};\n\nfunction shouldFlushQueue(props) {\n  if (props.capacity > 0 && props.interval >= props.config.interval) {\n    return true;\n  }\n  else if (props.capacity >= props.config.capacity) {\n    return true;\n  }\n  return false;\n}\n","export function timer(num){\n  if (this instanceof timer === false) {\n    return new timer(num);\n  }\n  this.count = num || 0;\n  return this;\n}\n\ntimer.prototype.start = function(){\n  var self = this;\n  this.pause();\n  this.interval = setInterval(function(){\n    self.count++;\n  }, 1000);\n  return this;\n};\n\ntimer.prototype.pause = function(){\n  clearInterval(this.interval);\n  return this;\n};\n\ntimer.prototype.value = function(){\n  return this.count;\n};\n\ntimer.prototype.clear = function(){\n  this.count = 0;\n  return this;\n};\n","// via: http://stackoverflow.com/a/2117523/2511985\n\nexport function getUniqueId(){\n  var str = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx';\n  return str.replace(/[xy]/g, function(c) {\n    var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);\n    return v.toString(16);\n  });\n}\n","export function getDatetimeIndex(input){\n  var date = input || new Date();\n  return {\n    'hour_of_day'  : date.getHours(),\n    'day_of_week'  : parseInt( 1 + date.getDay() ),\n    'day_of_month' : date.getDate(),\n    'month'        : parseInt( 1 + date.getMonth() ),\n    'year'         : date.getFullYear()\n  };\n}\n","import Keen from './index';\nimport each from 'keen-core/lib/utils/each';\nimport { queue } from './utils/queue';\n\nexport function deferEvent(eventCollection, eventBody){\n\n  if (arguments.length !== 2 || typeof eventCollection !== 'string') {\n    handleValidationError.call(this, 'Incorrect arguments provided to #deferEvent method');\n    return;\n  }\n\n  this.queue.events[eventCollection] = this.queue.events[eventCollection] || [];\n  this.queue.events[eventCollection].push(eventBody);\n  this.queue.capacity++;\n  if (!this.queue.timer) {\n    this.queue.start();\n  }\n  this.emit('deferEvent', eventCollection, eventBody);\n  return this;\n}\n\nexport function deferEvents(eventsHash){\n  var self = this;\n\n  if (arguments.length !== 1 || typeof eventsHash !== 'object') {\n    handleValidationError.call(this, 'Incorrect arguments provided to #deferEvents method');\n    return;\n  }\n\n  each(eventsHash, function(eventList, eventCollection){\n    self.queue.events[eventCollection] = self.queue.events[eventCollection] || [];\n    self.queue.events[eventCollection] = self.queue.events[eventCollection].concat(eventList);\n    self.queue.capacity = self.queue.capacity + eventList.length;\n    if (!self.queue.timer) {\n      self.queue.start();\n    }\n  });\n  self.emit('deferEvents', eventsHash);\n  return self;\n}\n\nexport function queueCapacity(num){\n  if (!arguments.length) return this.queue.config.capacity;\n  this.queue.config.capacity = num ? Number(num): 0;\n  this.queue.check();\n  return this;\n}\n\nexport function queueInterval(num){\n  if (!arguments.length) return this.queue.config.interval;\n  this.queue.config.interval = num ? Number(num): 0;\n  this.queue.check();\n  return this;\n}\n\nexport function recordDeferredEvents(){\n  var self = this,\n      clonedQueueConfig,\n      clonedQueueEvents;\n\n  if (self.queue.capacity > 0) {\n    self.queue.pause();\n    clonedQueueConfig = JSON.parse(JSON.stringify(self.queue.config));\n    clonedQueueEvents = JSON.parse(JSON.stringify(self.queue.events));\n    self.queue = queue();\n    self.queue.config = clonedQueueConfig;\n    self.queue.on('flush', function(){\n      self.recordDeferredEvents();\n    });\n    self.emit('recordDeferredEvents', clonedQueueEvents);\n    self.recordEvents(clonedQueueEvents, function(err, res){\n      if (err) {\n        // Retry once\n        self.recordEvents(clonedQueueEvents);\n      }\n      else {\n        clonedQueueEvents = undefined;\n      }\n    });\n  }\n  return self;\n}\n\nfunction handleValidationError(message){\n  var err = 'Event(s) not deferred: ' + message;\n  this.emit('error', err);\n}\n","module.exports = require(\"https\");","module.exports = require(\"http\");","import Keen from './index';\nimport each from 'keen-core/lib/utils/each';\nimport extend from 'keen-core/lib/utils/extend';\nimport { getExtendedEventBody } from './extend-events';\nimport http from 'http';\nimport https from 'https';\n\n// ------------------------------\n// .recordEvent\n// ------------------------------\n\nexport function recordEvent(eventCollection, eventBody, callback){\n  var url, data, cb, extendedEventBody;\n\n  data = {};\n  cb = callback || function(){};\n  callback = null;\n\n  if (!checkValidation.call(this, cb)) {\n    return;\n  }\n\n  if (!eventCollection || typeof eventCollection !== 'string') {\n    handleValidationError.call(this, 'Collection name must be a string.', cb);\n    return;\n  }\n\n  // ------------------------------\n  // DEPRECATED\n  // Apply client.globalProperties\n  // ------------------------------\n  if (this.config.globalProperties) {\n    data = this.config.globalProperties(eventCollection);\n  }\n  extend(data, eventBody);\n\n  // ------------------------------\n  // Run extendEvent(s) transforms\n  // ------------------------------\n  extendedEventBody = {};\n  getExtendedEventBody(extendedEventBody, this.extensions.events);\n  getExtendedEventBody(extendedEventBody, this.extensions.collections[eventCollection]);\n  getExtendedEventBody(extendedEventBody, [data]);\n\n  this.emit('recordEvent', eventCollection, extendedEventBody);\n\n  if (!Keen.enabled) {\n    handleValidationError.call(this, 'Keen.enabled is set to false.', cb);\n    return false;\n  }\n\n  sendEventData.call(this, encodeURIComponent(eventCollection), extendedEventBody, cb);\n  cb = null;\n  return this;\n}\n\n\n\n// ------------------------------\n// .recordEvents\n// ------------------------------\n\nexport function recordEvents(eventsHash, callback){\n  var self = this, url, cb, extendedEventsHash;\n\n  cb = callback || function(){};\n  callback = null;\n\n  if (!checkValidation.call(this, cb)) {\n    return;\n  }\n\n  if (arguments.length > 2) {\n    handleValidationError.call(this, 'Incorrect arguments provided to #addEvents method', cb);\n    return;\n  }\n\n  // ------------------------------\n  // DEPRECATED\n  // Apply client.globalProperties\n  // ------------------------------\n  if (this.config.globalProperties) {\n    // Loop over each set of events\n    each(eventsHash, function(events, collection){\n      // Loop over each individual event\n      each(events, function(body, index){\n        // Start with global properties for this collection\n        var modified = self.config.globalProperties(collection);\n        // Apply provided properties for this event body\n        eventsHash[collection][index] = extend(modified, body);\n      });\n    });\n  }\n\n  // ------------------------------\n  // Run extendEvent(s) transforms\n  // ------------------------------\n  extendedEventsHash = {};\n  each(eventsHash, function(eventList, eventCollection){\n    // Find or create collection on new hash\n    extendedEventsHash[eventCollection] = extendedEventsHash[eventCollection] || [];\n    // Loop over each eventBody in the existing hash\n    each(eventList, function(eventBody, index){\n      // Create a new data object\n      var extendedEventBody = {};\n      // Process \"events\" transform pipeline\n      getExtendedEventBody(extendedEventBody, self.extensions.events);\n      // Process \"collection\" transform pipeline\n      getExtendedEventBody(extendedEventBody, self.extensions.collections[eventCollection]);\n      // Blend existing eventBody data into the result\n      getExtendedEventBody(extendedEventBody, [eventBody]);\n      // Push extendedEventBody into new hash\n      extendedEventsHash[eventCollection].push(extendedEventBody);\n    });\n  });\n\n  this.emit('recordEvents', extendedEventsHash);\n\n  if (!Keen.enabled) {\n    handleValidationError.call(this, 'Keen.enabled is set to false.', cb);\n    return false;\n  }\n\n  sendEventData.call(this, undefined, extendedEventsHash, cb);\n  cb = null;\n  return this;\n}\n\n\n// ----------------------\n// DEPRECATED\n// ----------------------\n\nexport function addEvent(){\n  this.emit('error', 'This method has been deprecated. Check out #recordEvent: https://github.com/keen/keen-tracking.js#record-a-single-event');\n  recordEvent.apply(this, arguments);\n}\n\nexport function addEvents(){\n  this.emit('error', 'This method has been deprecated. Check out #recordEvents: https://github.com/keen/keen-tracking.js#record-multiple-events');\n  recordEvents.apply(this, arguments);\n}\n\n\n// ------------------------------\n// Validation\n// ------------------------------\n\nfunction checkValidation(callback){\n  var cb = callback;\n  callback = null;\n\n  if (!this.projectId()) {\n    handleValidationError.call(this, 'Keen.Client is missing a projectId property.', cb);\n    return false;\n  }\n  if (!this.writeKey()) {\n    handleValidationError.call(this, 'Keen.Client is missing a writeKey property.', cb);\n    return false;\n  }\n  return true;\n}\n\nfunction handleValidationError(message, cb){\n  var err = 'Event(s) not recorded: ' + message;\n  this.emit('error', err);\n  if (cb) {\n    cb.call(this, err, null);\n    cb = null;\n  }\n}\n\nfunction sendEventData(path, eventData, callback){\n  var data = JSON.stringify(eventData),\n      url;\n\n  url = this.url('events', path);\n  url = url.replace(this.config.protocol + '://' + this.config.host, '');\n\n  var options = {\n    host: this.config.host,\n    path: url,\n    method: 'POST',\n    headers: {\n      'Authorization': this.writeKey(),\n      'Content-Type': 'application/json',\n      'Content-Length': Buffer.byteLength(data)\n    }\n  };\n  var protocol = (this.config.protocol === 'http') ? http : https;\n  var req = protocol.request(options, function(response) {\n    var body = '';\n    response.on('data', function(d) {\n      body += d;\n    });\n    response.on('end', function() {\n      var response, error;\n      try {\n        response = JSON.parse(body);\n      }\n      catch (e) {\n        // Parsing Error\n        error = e;\n      }\n      if (!error && response.error_code) {\n        // API Error\n        error = new Error(response.message || 'Unknown error occurred');\n        error.code = response.error_code;\n      }\n      if (callback) {\n        if (error) {\n          callback(error, null);\n        }\n        if (response) {\n          callback(null, response);\n        }\n      }\n    });\n  });\n  req.on('error', callback);\n  req.write(data);\n  req.end();\n}\n","module.exports = __WEBPACK_EXTERNAL_MODULE__14__;","module.exports = __WEBPACK_EXTERNAL_MODULE__15__;","import KeenCore from './index';\nimport extend from 'keen-core/lib/utils/extend';\nimport {\n  recordEvent,\n  recordEvents,\n  addEvent,\n  addEvents\n} from './record-events-server';\nimport {\n  deferEvent,\n  deferEvents,\n  queueCapacity,\n  queueInterval,\n  recordDeferredEvents\n} from './defer-events';\nimport { extendEvent, extendEvents } from './extend-events';\nimport { getDatetimeIndex } from './helpers/getDatetimeIndex';\nimport { getUniqueId } from './helpers/getUniqueId';\nimport { deepExtend } from './utils/deepExtend';\nimport { timer } from './utils/timer';\nimport pkg from '../package.json';\n\n// ------------------------\n// Methods\n// ------------------------\nextend(KeenCore.prototype, {\n  recordEvent,\n  recordEvents,\n  addEvent,\n  addEvents\n});\nextend(KeenCore.prototype, {\n  deferEvent,\n  deferEvents,\n  queueCapacity,\n  queueInterval,\n  recordDeferredEvents\n});\nextend(KeenCore.prototype, {\n  extendEvent,\n  extendEvents\n});\n\n// ------------------------\n// Helpers\n// ------------------------\nextend(KeenCore.helpers, {\n  getDatetimeIndex,\n  getUniqueId\n});\n\n// ------------------------\n// Utils\n// ------------------------\nextend(KeenCore.utils, {\n  deepExtend,\n  timer\n});\n\nKeenCore.version = pkg.version;\n\nexport const Keen = KeenCore;\nmodule.exports = Keen;\n"],"sourceRoot":""}