{"version":3,"sources":["webpack://Keen/webpack/bootstrap","webpack://Keen/./node_modules/keen-core/lib/utils/each.js","webpack://Keen/./node_modules/keen-core/lib/utils/extend.js","webpack://Keen/./node_modules/keen-core/lib/index.js","webpack://Keen/./node_modules/js-cookie/src/js.cookie.js","webpack://Keen/(webpack)/buildin/global.js","webpack://Keen/./node_modules/promise-polyfill/src/polyfill.js","webpack://Keen/./node_modules/component-emitter/index.js","webpack://Keen/./node_modules/promise-polyfill/src/finally.js","webpack://Keen/./node_modules/whatwg-fetch/fetch.js","webpack://Keen/./node_modules/promise-polyfill/src/index.js","webpack://Keen/./node_modules/keen-core/lib/utils/base64.js","webpack://Keen/./node_modules/keen-core/lib/utils/parse-params.js","webpack://Keen/./node_modules/keen-core/lib/utils/serialize.js","webpack://Keen/./node_modules/timers-browserify/main.js","webpack://Keen/./node_modules/setimmediate/setImmediate.js","webpack://Keen/./node_modules/node-libs-browser/node_modules/process/browser.js","webpack://Keen/./lib/config-default.js","webpack://Keen/./lib/utils/queue.js","webpack://Keen/./lib/index.js","webpack://Keen/./lib/utils/listener.js","webpack://Keen/./lib/utils/deepExtend.js","webpack://Keen/./lib/extend-events.js","webpack://Keen/./lib/utils/fetchRetry.js","webpack://Keen/./lib/utils/md5.js","webpack://Keen/./lib/utils/cache-browser.js","webpack://Keen/./lib/utils/unique.js","webpack://Keen/./lib/record-events-browser.js","webpack://Keen/./lib/defer-events.js","webpack://Keen/./lib/browser-auto-tracking.js","webpack://Keen/./lib/helpers/getScreenProfile.js","webpack://Keen/./lib/helpers/getWindowProfile.js","webpack://Keen/./lib/helpers/getBrowserProfile.js","webpack://Keen/./lib/helpers/getDatetimeIndex.js","webpack://Keen/./lib/helpers/getDomainName.js","webpack://Keen/./lib/helpers/getDomNodePath.js","webpack://Keen/./lib/helpers/getDomNodeAttributes.js","webpack://Keen/./lib/helpers/getBasicDomNodeProfile.js","webpack://Keen/./lib/helpers/getNParents.js","webpack://Keen/./lib/helpers/getDomNodeProfile.js","webpack://Keen/./lib/helpers/getScrollState.js","webpack://Keen/./lib/helpers/getUniqueId.js","webpack://Keen/./lib/utils/cookie.js","webpack://Keen/./lib/utils/serializeForm.js","webpack://Keen/./lib/utils/timer.js","webpack://Keen/./lib/browser.js"],"names":["configDefault","queue","capacity","interval","retry","limit","initialDelay","retryOnResponseStatuses","unique","cache","dbName","dbCollectionName","dbCollectionKey","maxAge","configQueue","config","events","timer","Emitter","prototype","check","shouldFlushQueue","flush","pause","emit","clearInterval","start","self","setInterval","props","KeenCore","helpers","on","client","extensions","collections","recordDeferredEvents","writeKey","str","arguments","length","String","referrerPolicy","setGlobalProperties","log","listenerCore","ctx","domListeners","listener","selector","fn","addListener","eventHandler","push","once","off","apply","survivors","each","handler","i","e","hash","eventType","evt","target","window","event","srcElement","handlers","key","matches","document","addEventListener","attachEvent","elem","nodeList","parentNode","querySelectorAll","deepExtend","Array","j","indexOf","prop","clone","undefined","input","JSON","parse","stringify","extendEvent","eventCollection","eventModifier","handleValidationError","call","extendEvents","eventsModifier","message","getExtendedEventBody","result","modifierResult","url","options","retriesLimit","retryInitialDelay","retryOn","retriesCount","name","Promise","resolve","reject","wrappedFetch","n","fetch","then","response","status","catch","error","setTimeout","MD5","d","M","V","Y","X","toLowerCase","_","m","f","r","charCodeAt","charAt","fromCharCode","h","t","g","md5_ii","md5_hh","md5_gg","md5_ff","safe_add","md5_cmn","bit_rol","indexedDBAvailable","cachingEnabled","db","cacheConfig","initializeIndexedDb","requestCacheConfig","dbConnectionRequest","indexedDB","open","onerror","onupgradeneeded","objectStore","createObjectStore","keyPath","createIndex","onsuccess","saveToCache","configOptions","transactionSave","transaction","requestSave","add","expiryTime","Date","now","getFromCache","transactionCleanUp","indexCleanUp","index","upperBoundOpenKeyRange","IDBKeyRange","upperBound","openCursor","cursor","transactionDelete","delete","value","continue","transactionIndex","responseFromCache","get","uniqueIds","isUnique","customCacheConfig","extendedEventBody","configCache","stringifiedEvent","hashingMethod","md5","item","filter","alreadySentEvent","find","storage","recordEvent","eventCollectionOrConfigObject","eventBody","callback","useBeaconApi","configObject","clientConfig","collection","encodeURIComponent","data","checkValidation","extend","extendedEventsHash","isUniqueResult","created","Keen","enabled","send","recordEvents","eventsHash","eventList","requestType","navigator","sendBeacon","getRequestUrl","api_key","base64","encode","modified","getTime","getRequestUrlOkLength","getUrlMaxLength","sendFetch","method","fetchRetry","body","mode","redirect","headers","connectionError","ok","json","responseJSON","error_code","statusText","eventsSavedSuccessfuly","checkEventsSavedSuccessfuly","responseKeys","Object","keys","notSavedEvents","map","success","projectId","err","userAgent","appVersion","img","createElement","loaded","onload","naturalHeight","naturalWidth","width","height","src","deferEvent","deferEvents","concat","queueCapacity","num","Number","queueInterval","clonedQueueConfig","clonedQueueEvents","res","unloadDeferredEvents","initAutoTrackingCore","lib","obj","utils","ignoreDisabledFormFields","ignoreFormFieldTypes","recordClicks","recordFormSubmits","recordInputChanges","recordPageUnloads","recordPageViews","recordPageViewsOnExit","recordScrollState","shareUuidAcrossDomains","collectIpAddress","collectUuid","catchError","defaultDomElementOptions","recordTextContent","redactTextContent","domElementOptions","session_cookie","cookie","session_uuid","getUniqueId","set","expire","prodperfectTestData","domainName","getDomainName","location","hostname","cookieDomain","domain","uuid","initialReferrer","referrer","scrollState","getScrollState","tracker_loaded_at_time","toISOString","tracker_load_uuid_value","addons","ua_string","output","date_time","ip_address","ip","remove_ip_property","browserProfile","getBrowserProfile","event_uuid","iso_time_full","local_time_full","toString","session","tracked_by","pkg","version","tracker_load_uuid","tracker_loaded_at","prodperfect_test_data","user","page","title","description","scroll_state","time_on_page","getSecondsSinceDate","time_on_page_ms","getMiliSecondsSinceDate","geo","user_agent","tech","profile","full","href","info","initial","time","local","utc","keen","timestamp","el","element","getDomNodeProfile","serializerOptions","disabled","ignoreTypes","fields","serializeForm","x","form","action","date","Math","round","getScreenProfile","screen","orientation","innerWidth","innerHeight","getWindowProfile","html","documentElement","offsetHeight","offsetWidth","max","scrollHeight","clientHeight","ratio","availHeight","parseFloat","toFixed","availWidth","cookieEnabled","appCodeName","getDocumentDescription","language","appName","onLine","platform","querySelector","content","getDatetimeIndex","getHours","parseInt","getDay","getDate","getMonth","getFullYear","extractHostname","split","splitArr","arrLen","getDomNodePath","nodeName","stack","sibCount","sibIndex","childNodes","sib","hasAttribute","id","unshift","slice","join","getDomNodeAttributes","attributeNodes","attributes","attrs","node","test","EXCLUDE_VALUE_REGEX","getBasicDomNodeProfile","class","className","all_attrs","node_name","tag_name","tagName","text","type","getNParents","nParents","parents","parent","nth_parent","getTextContent","textContent","n_parents","text_content","x_position","offsetLeft","clientLeft","y_position","offsetTop","clientTop","state","pixel","pixel_max","ratio_max","getScrollOffset","getWindowHeight","getScrollableArea","pageYOffset","scrollTop","crypto","getRandomValues","replace","c","Uint8Array","random","v","expires","Cookies","getJSON","daysUntilExpire","remove","k_r_submitter","k_r_success_contrls","brackets","serializer","hash_serializer","str_serialize","elements","radio_store","create","val","checked","empty","selectOptions","isSelectedOptions","option","allowedEmpty","hasValue","selected","parse_keys","string","prefix","children","RegExp","match","exec","hash_assign","shift","between","isArray","_values","isNaN","existing","count","clear","initAutoTracking","listenTo","listenerHash","keenGlobals","webpackKeenGlobals","extendLibrary","KeenTracking"],"mappings":";;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;AClFA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,YAAY;AACzB;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AC1BA;;AAEA;AACA,iBAAiB,sBAAsB;AACvC;AACA;AACA;AACA;AACA;AACA;;;;;;;ACTA;AACA;AACA,aAAa,mBAAO,CAAC,CAAc;AACnC,eAAe,mBAAO,CAAC,CAAgB;AACvC,oBAAoB,mBAAO,CAAC,EAAsB;AAClD,kBAAkB,mBAAO,CAAC,EAAmB;;AAE7C,gBAAgB,mBAAO,CAAC,CAAmB;;AAE3C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA,oBAAoB,SAAS,IAAI,KAAK;AACtC,oBAAoB,SAAS,IAAI,KAAK;AACtC,oBAAoB,SAAS,IAAI,KAAK;AACtC,oBAAoB,SAAS,IAAI,KAAK,eAAe,UAAU;AAC/D,oBAAoB,SAAS,IAAI,KAAK,eAAe,UAAU;AAC/D,oBAAoB,SAAS,IAAI,KAAK,eAAe,UAAU;AAC/D,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA,kDAAkD,SAAS,IAAI,KAAK;AACpE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,8BAA8B,YAAY;AAC1C;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,CAAC,sIAAsI;;;;;;;;ACnOvI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,IAA0C;AAC/C,EAAE,oCAAO,OAAO;AAAA;AAAA;AAAA;AAAA,oGAAC;AACjB,EAAE,MAAM,yBASN;AACF,CAAC;AACD;AACA;AACA;AACA,QAAQ,sBAAsB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,6BAA6B;AAC7B,6BAA6B;AAC7B,6BAA6B;AAC7B,2BAA2B;AAC3B;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,2DAA2D;AAC3D,6BAA6B,EAAE;AAC/B;;AAEA,SAAS,oBAAoB;AAC7B;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;;AAEA;AACA;;AAEA,2BAA2B;AAC3B,CAAC;;;;;;;AChJD;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C;;;;;;;;ACnBA;AAAA;AAA8B;AACS;;AAEvC,eAAe,cAAc;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,wBAAwB,sDAAO;AAC/B,CAAC;AACD,0CAA0C,wDAAc;AACxD;;;;;;;;;ACvBA;AACA;AACA;;AAEA,IAAI,IAA6B;AACjC;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,sBAAsB;AACvC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,MAAM;AACjB,YAAY;AACZ;;AAEA;AACA;;AAEA;AACA;;AAEA,iBAAiB,sBAAsB;AACvC;AACA;;AAEA;AACA;AACA,2CAA2C,SAAS;AACpD;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;;AAEA;AACA;AACA;;;;;;;;AC9KA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEe,2EAAkB,EAAC;;;;;;;ACnBlC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wCAAwC,mBAAmB;AAC3D;AACA;;AAEA;AACA;AACA,kCAAkC,oBAAoB;AACtD;AACA;;AAEA;AACA;AACA,wCAAwC,4BAA4B;AACpE;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA,uDAAuD;AACvD,SAAS;AACT;AACA,SAAS;AACT,8EAA8E;AAC9E;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,8BAA8B,uBAAuB;AACrD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA,uCAAuC,0BAA0B;AACjE;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,+BAA+B,0BAA0B,eAAe;AACxE;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,OAAO;;AAEP;AACA,KAAK;AACL;AACA;AACA,CAAC;;;;;;;;;;;;;;ACjdD;AAAuC;;AAEvC;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,kBAAkB;AAC/B;AACA,aAAa,kBAAkB;AAC/B;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA,+CAA+C,SAAS;AACxD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,+BAA+B,wDAAc;;AAE7C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA,mBAAmB,iBAAiB;AACpC;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA,wCAAwC,SAAS;AACjD;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA,+DAA+D;AAC/D;AACA;;AAEe,gEAAO,EAAC;;;;;;;;AC/OvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,wBAAwB;AACrD,qBAAqB,oCAAoC;AACzD;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC,oCAAoC;AACpC,iCAAiC;AACjC;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;;;;;;;;;;;;;AC7CA;;AAEA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA,6BAA6B,+CAA+C,EAAE;AAC9E;;AAEA;AACA;AACA;AACA;AACA;;;;;;;ACfA,WAAW,mBAAO,CAAC,CAAQ;AAC3B,aAAa,mBAAO,CAAC,CAAU;;AAE/B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;;;;;;ACdA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA,mBAAO,CAAC,EAAc;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC9DA;AACA;;AAEA;AACA;AACA;;AAEA,uBAAuB;AACvB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,iBAAiB;AACtC;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,0CAA0C,sBAAsB,EAAE;AAClE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA;;AAEA,KAAK;AACL;AACA;;AAEA,KAAK;AACL;AACA;;AAEA,KAAK;AACL;AACA;;AAEA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA,CAAC;;;;;;;;ACzLD;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,qCAAqC;;AAErC;AACA;AACA;;AAEA,2BAA2B;AAC3B;AACA;AACA;AACA,4B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","file":"keen-tracking.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 12);\n","module.exports = each;\n\nfunction each(o, cb, s){\n  var n;\n  if (!o){\n    return 0;\n  }\n  s = !s ? o : s;\n  if (o instanceof Array){\n    // Indexed arrays, needed for Safari\n    for (n=0; n<o.length; n++) {\n      if (cb.call(s, o[n], n, o) === false){\n        return 0;\n      }\n    }\n  } else {\n    // Hashtables\n    for (n in o){\n      if (o.hasOwnProperty(n)) {\n        if (cb.call(s, o[n], n, o) === false){\n          return 0;\n        }\n      }\n    }\n  }\n  return 1;\n}\n","module.exports = extend;\n\nfunction extend(target){\n  for (var i = 1; i < arguments.length; i++) {\n    for (var prop in arguments[i]){\n      target[prop] = arguments[i][prop];\n    }\n  }\n  return target;\n};\n","(function(env){\n  var previousKeen = env.Keen || undefined;\n  var each = require('./utils/each'),\n      extend = require('./utils/extend'),\n      parseParams = require('./utils/parse-params'),\n      serialize = require('./utils/serialize');\n\n  var Emitter = require('component-emitter');\n\n  function Client(props){\n    if (this instanceof Client === false) {\n      return new Client(props);\n    }\n    this.configure(props);\n\n    // Set up event handling\n    if (Client.debug) {\n      this.on('error', Client.log);\n    }\n    this.emit('ready');\n    Client.emit('client', this);\n  }\n\n  if (previousKeen && typeof previousKeen.resources === 'undefined') {\n    Client.legacyVersion = previousKeen;\n  }\n\n  Emitter(Client);\n  Emitter(Client.prototype);\n\n  extend(Client, {\n    debug: false,\n    enabled: true,\n    loaded: false,\n    version: '__VERSION__'\n  });\n\n  // Set or extend helpers\n  Client.helpers = Client.helpers || {};\n\n  // Set or extend resources\n  Client.resources = Client.resources || {};\n  extend(Client.resources, {\n    'base'      : '{protocol}://{host}',\n    'version'   : '{protocol}://{host}/3.0',\n    'projects'  : '{protocol}://{host}/3.0/projects',\n    'projectId' : '{protocol}://{host}/3.0/projects/{projectId}',\n    'events'    : '{protocol}://{host}/3.0/projects/{projectId}/events',\n    'queries'   : '{protocol}://{host}/3.0/projects/{projectId}/queries'\n  });\n\n  // Set or extend utils\n  Client.utils = Client.utils || {};\n  extend(Client.utils, {\n    'each'        : each,\n    'extend'      : extend,\n    'parseParams' : parseParams,\n    'serialize'   : serialize\n  });\n\n  Client.extendLibrary = function(target, source) {\n    var previous = previousKeen || source;\n    if (isDefined(previous) && isDefined(previous.resources)) {\n      each(previous, function(value, key) {\n        if (typeof value === 'object') {\n          target[key] = target[key] || {};\n          extend(target[key], value);\n        }\n        else {\n          target[key] = target[key] || value;\n        }\n      });\n      extend(target.prototype, previous.prototype);\n    }\n    return target;\n  };\n\n  Client.log = function(str){\n    if (Client.debug && typeof console === 'object') {\n      console.log('[Keen]', str);\n    }\n  };\n\n  Client.noConflict = function(){\n    if (typeof env.Keen !== 'undefined') {\n      env.Keen = Client.legacyVersion || previousKeen;\n    }\n    return Client;\n  };\n\n  Client.ready = function(fn){\n    if (Client.loaded) {\n      fn();\n    }\n    else {\n      Client.once('ready', fn);\n    }\n  };\n\n  Client.prototype.configure = function(obj){\n    var config = obj || {};\n    this.config = this.config || {\n      projectId    : undefined,\n      writeKey     : undefined,\n      host         : 'api.keen.io',\n      protocol     : 'https',\n      requestType  : 'jsonp',\n      resources    : extend({}, Client.resources)\n    };\n\n    // IE<10 request shim\n    if (typeof window !== 'undefined' && window.navigator && window.navigator.userAgent && window.navigator.userAgent.indexOf('MSIE') > -1) {\n      config.protocol = document.location.protocol.replace(':', '');\n    }\n\n    if (config.host) {\n      config.host.replace(/.*?:\\/\\//g, '');\n    }\n\n    extend(this.config, config);\n    return this;\n  };\n\n  Client.prototype.masterKey = function(str){\n    if (!arguments.length) return this.config.masterKey;\n    this.config.masterKey = str ? String(str) : null;\n    return this;\n  };\n\n  Client.prototype.projectId = function(str){\n    if (!arguments.length) return this.config.projectId;\n    this.config.projectId = (str ? String(str) : null);\n    return this;\n  };\n\n  Client.prototype.resources = function(obj){\n    if (!arguments.length) return this.config.resources;\n    var self = this;\n    if (typeof obj === 'object') {\n      each(obj, function(value, key){\n        self.config.resources[key] = (value ? value : null);\n      });\n    }\n    return self;\n  };\n\n  Client.prototype.url = function(name){\n    var args = Array.prototype.slice.call(arguments, 1),\n        baseUrl = this.config.resources.base || '{protocol}://{host}',\n        path;\n\n    if (name && typeof name === 'string') {\n      if (this.config.resources[name]) {\n        path = this.config.resources[name];\n      }\n      else {\n        path = baseUrl + name;\n      }\n    }\n    else {\n      path = baseUrl;\n    }\n\n    each(this.config, function(value, key){\n      if (typeof value !== 'object') {\n        path = path.replace('{' + key + '}', value);\n      }\n    });\n\n    each(args, function(arg, i){\n      if (typeof arg === 'string') {\n        path += '/' + arg;\n      }\n      else if (typeof arg === 'object') {\n        path += '?';\n        each(arg, function(value, key){\n          path += key + '=' + value + '&';\n        });\n        path = path.slice(0, -1);\n      }\n    });\n\n    return path;\n  };\n\n  domReady(function(){\n    Client.loaded = true;\n    Client.emit('ready');\n  });\n\n  function domReady(fn){\n    if (Client.loaded || typeof document === 'undefined') {\n      fn();\n      return;\n    }\n    // Firefox 3.5 shim\n    if(document.readyState == null && document.addEventListener){\n      document.addEventListener('DOMContentLoaded', function DOMContentLoaded(){\n        document.removeEventListener('DOMContentLoaded', DOMContentLoaded, false);\n        document.readyState = 'complete';\n      }, false);\n      document.readyState = 'loading';\n    }\n    testDom(fn);\n  }\n\n  function testDom(fn){\n    if (/in/.test(document.readyState)) {\n      setTimeout(function(){\n        testDom(fn);\n      }, 9);\n    }\n    else {\n      fn();\n    }\n  }\n\n  function isDefined(target) {\n    return typeof target !== 'undefined';\n  }\n\n  function isUndefined(target) {\n    return typeof target === 'undefined';\n  }\n\n  module.exports = Client;\n\n}).call(this, typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {});\n","/*!\n * JavaScript Cookie v2.1.0\n * https://github.com/js-cookie/js-cookie\n *\n * Copyright 2006, 2015 Klaus Hartl & Fagner Brack\n * Released under the MIT license\n */\n(function (factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(factory);\n\t} else if (typeof exports === 'object') {\n\t\tmodule.exports = factory();\n\t} else {\n\t\tvar _OldCookies = window.Cookies;\n\t\tvar api = window.Cookies = factory();\n\t\tapi.noConflict = function () {\n\t\t\twindow.Cookies = _OldCookies;\n\t\t\treturn api;\n\t\t};\n\t}\n}(function () {\n\tfunction extend () {\n\t\tvar i = 0;\n\t\tvar result = {};\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar attributes = arguments[ i ];\n\t\t\tfor (var key in attributes) {\n\t\t\t\tresult[key] = attributes[key];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction init (converter) {\n\t\tfunction api (key, value, attributes) {\n\t\t\tvar result;\n\n\t\t\t// Write\n\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tattributes = extend({\n\t\t\t\t\tpath: '/'\n\t\t\t\t}, api.defaults, attributes);\n\n\t\t\t\tif (typeof attributes.expires === 'number') {\n\t\t\t\t\tvar expires = new Date();\n\t\t\t\t\texpires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e+5);\n\t\t\t\t\tattributes.expires = expires;\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tresult = JSON.stringify(value);\n\t\t\t\t\tif (/^[\\{\\[]/.test(result)) {\n\t\t\t\t\t\tvalue = result;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\n\t\t\t\tif (!converter.write) {\n\t\t\t\t\tvalue = encodeURIComponent(String(value))\n\t\t\t\t\t\t.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\n\t\t\t\t} else {\n\t\t\t\t\tvalue = converter.write(value, key);\n\t\t\t\t}\n\n\t\t\t\tkey = encodeURIComponent(String(key));\n\t\t\t\tkey = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);\n\t\t\t\tkey = key.replace(/[\\(\\)]/g, escape);\n\n\t\t\t\treturn (document.cookie = [\n\t\t\t\t\tkey, '=', value,\n\t\t\t\t\tattributes.expires && '; expires=' + attributes.expires.toUTCString(), // use expires attribute, max-age is not supported by IE\n\t\t\t\t\tattributes.path    && '; path=' + attributes.path,\n\t\t\t\t\tattributes.domain  && '; domain=' + attributes.domain,\n\t\t\t\t\tattributes.secure ? '; secure' : ''\n\t\t\t\t].join(''));\n\t\t\t}\n\n\t\t\t// Read\n\n\t\t\tif (!key) {\n\t\t\t\tresult = {};\n\t\t\t}\n\n\t\t\t// To prevent the for loop in the first place assign an empty array\n\t\t\t// in case there are no cookies at all. Also prevents odd result when\n\t\t\t// calling \"get()\"\n\t\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\n\t\t\tvar rdecode = /(%[0-9A-Z]{2})+/g;\n\t\t\tvar i = 0;\n\n\t\t\tfor (; i < cookies.length; i++) {\n\t\t\t\tvar parts = cookies[i].split('=');\n\t\t\t\tvar name = parts[0].replace(rdecode, decodeURIComponent);\n\t\t\t\tvar cookie = parts.slice(1).join('=');\n\n\t\t\t\tif (cookie.charAt(0) === '\"') {\n\t\t\t\t\tcookie = cookie.slice(1, -1);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tcookie = converter.read ?\n\t\t\t\t\t\tconverter.read(cookie, name) : converter(cookie, name) ||\n\t\t\t\t\t\tcookie.replace(rdecode, decodeURIComponent);\n\n\t\t\t\t\tif (this.json) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcookie = JSON.parse(cookie);\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (key === name) {\n\t\t\t\t\t\tresult = cookie;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!key) {\n\t\t\t\t\t\tresult[name] = cookie;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\tapi.get = api.set = api;\n\t\tapi.getJSON = function () {\n\t\t\treturn api.apply({\n\t\t\t\tjson: true\n\t\t\t}, [].slice.call(arguments));\n\t\t};\n\t\tapi.defaults = {};\n\n\t\tapi.remove = function (key, attributes) {\n\t\t\tapi(key, '', extend(attributes, {\n\t\t\t\texpires: -1\n\t\t\t}));\n\t\t};\n\n\t\tapi.withConverter = init;\n\n\t\treturn api;\n\t}\n\n\treturn init(function () {});\n}));\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","import Promise from './index';\nimport promiseFinally from './finally';\n\n/** @suppress {undefinedVars} */\nvar globalNS = (function() {\n  // the only reliable means to get the global object is\n  // `Function('return this')()`\n  // However, this causes CSP violations in Chrome apps.\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n  throw new Error('unable to locate global object');\n})();\n\nif (!('Promise' in globalNS)) {\n  globalNS['Promise'] = Promise;\n} else if (!globalNS.Promise.prototype['finally']) {\n  globalNS.Promise.prototype['finally'] = promiseFinally;\n}\n","\r\n/**\r\n * Expose `Emitter`.\r\n */\r\n\r\nif (typeof module !== 'undefined') {\r\n  module.exports = Emitter;\r\n}\r\n\r\n/**\r\n * Initialize a new `Emitter`.\r\n *\r\n * @api public\r\n */\r\n\r\nfunction Emitter(obj) {\r\n  if (obj) return mixin(obj);\r\n};\r\n\r\n/**\r\n * Mixin the emitter properties.\r\n *\r\n * @param {Object} obj\r\n * @return {Object}\r\n * @api private\r\n */\r\n\r\nfunction mixin(obj) {\r\n  for (var key in Emitter.prototype) {\r\n    obj[key] = Emitter.prototype[key];\r\n  }\r\n  return obj;\r\n}\r\n\r\n/**\r\n * Listen on the given `event` with `fn`.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.on =\r\nEmitter.prototype.addEventListener = function(event, fn){\r\n  this._callbacks = this._callbacks || {};\r\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\r\n    .push(fn);\r\n  return this;\r\n};\r\n\r\n/**\r\n * Adds an `event` listener that will be invoked a single\r\n * time then automatically removed.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.once = function(event, fn){\r\n  function on() {\r\n    this.off(event, on);\r\n    fn.apply(this, arguments);\r\n  }\r\n\r\n  on.fn = fn;\r\n  this.on(event, on);\r\n  return this;\r\n};\r\n\r\n/**\r\n * Remove the given callback for `event` or all\r\n * registered callbacks.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.off =\r\nEmitter.prototype.removeListener =\r\nEmitter.prototype.removeAllListeners =\r\nEmitter.prototype.removeEventListener = function(event, fn){\r\n  this._callbacks = this._callbacks || {};\r\n\r\n  // all\r\n  if (0 == arguments.length) {\r\n    this._callbacks = {};\r\n    return this;\r\n  }\r\n\r\n  // specific event\r\n  var callbacks = this._callbacks['$' + event];\r\n  if (!callbacks) return this;\r\n\r\n  // remove all handlers\r\n  if (1 == arguments.length) {\r\n    delete this._callbacks['$' + event];\r\n    return this;\r\n  }\r\n\r\n  // remove specific handler\r\n  var cb;\r\n  for (var i = 0; i < callbacks.length; i++) {\r\n    cb = callbacks[i];\r\n    if (cb === fn || cb.fn === fn) {\r\n      callbacks.splice(i, 1);\r\n      break;\r\n    }\r\n  }\r\n\r\n  // Remove event specific arrays for event types that no\r\n  // one is subscribed for to avoid memory leak.\r\n  if (callbacks.length === 0) {\r\n    delete this._callbacks['$' + event];\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\n/**\r\n * Emit `event` with the given args.\r\n *\r\n * @param {String} event\r\n * @param {Mixed} ...\r\n * @return {Emitter}\r\n */\r\n\r\nEmitter.prototype.emit = function(event){\r\n  this._callbacks = this._callbacks || {};\r\n\r\n  var args = new Array(arguments.length - 1)\r\n    , callbacks = this._callbacks['$' + event];\r\n\r\n  for (var i = 1; i < arguments.length; i++) {\r\n    args[i - 1] = arguments[i];\r\n  }\r\n\r\n  if (callbacks) {\r\n    callbacks = callbacks.slice(0);\r\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\r\n      callbacks[i].apply(this, args);\r\n    }\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\n/**\r\n * Return array of callbacks for `event`.\r\n *\r\n * @param {String} event\r\n * @return {Array}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.listeners = function(event){\r\n  this._callbacks = this._callbacks || {};\r\n  return this._callbacks['$' + event] || [];\r\n};\r\n\r\n/**\r\n * Check if this emitter has `event` handlers.\r\n *\r\n * @param {String} event\r\n * @return {Boolean}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.hasListeners = function(event){\r\n  return !! this.listeners(event).length;\r\n};\r\n","/**\n * @this {Promise}\n */\nfunction finallyConstructor(callback) {\n  var constructor = this.constructor;\n  return this.then(\n    function(value) {\n      return constructor.resolve(callback()).then(function() {\n        return value;\n      });\n    },\n    function(reason) {\n      return constructor.resolve(callback()).then(function() {\n        return constructor.reject(reason);\n      });\n    }\n  );\n}\n\nexport default finallyConstructor;\n","(function(self) {\n  'use strict';\n\n  if (self.fetch) {\n    return\n  }\n\n  var support = {\n    searchParams: 'URLSearchParams' in self,\n    iterable: 'Symbol' in self && 'iterator' in Symbol,\n    blob: 'FileReader' in self && 'Blob' in self && (function() {\n      try {\n        new Blob()\n        return true\n      } catch(e) {\n        return false\n      }\n    })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  }\n\n  if (support.arrayBuffer) {\n    var viewClasses = [\n      '[object Int8Array]',\n      '[object Uint8Array]',\n      '[object Uint8ClampedArray]',\n      '[object Int16Array]',\n      '[object Uint16Array]',\n      '[object Int32Array]',\n      '[object Uint32Array]',\n      '[object Float32Array]',\n      '[object Float64Array]'\n    ]\n\n    var isDataView = function(obj) {\n      return obj && DataView.prototype.isPrototypeOf(obj)\n    }\n\n    var isArrayBufferView = ArrayBuffer.isView || function(obj) {\n      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n    }\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name)\n    }\n    if (/[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value)\n    }\n    return value\n  }\n\n  // Build a destructive iterator for the value list\n  function iteratorFor(items) {\n    var iterator = {\n      next: function() {\n        var value = items.shift()\n        return {done: value === undefined, value: value}\n      }\n    }\n\n    if (support.iterable) {\n      iterator[Symbol.iterator] = function() {\n        return iterator\n      }\n    }\n\n    return iterator\n  }\n\n  function Headers(headers) {\n    this.map = {}\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value)\n      }, this)\n    } else if (Array.isArray(headers)) {\n      headers.forEach(function(header) {\n        this.append(header[0], header[1])\n      }, this)\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name])\n      }, this)\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name)\n    value = normalizeValue(value)\n    var oldValue = this.map[name]\n    this.map[name] = oldValue ? oldValue+','+value : value\n  }\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)]\n  }\n\n  Headers.prototype.get = function(name) {\n    name = normalizeName(name)\n    return this.has(name) ? this.map[name] : null\n  }\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  }\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = normalizeValue(value)\n  }\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    for (var name in this.map) {\n      if (this.map.hasOwnProperty(name)) {\n        callback.call(thisArg, this.map[name], name, this)\n      }\n    }\n  }\n\n  Headers.prototype.keys = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push(name) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.values = function() {\n    var items = []\n    this.forEach(function(value) { items.push(value) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.entries = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push([name, value]) })\n    return iteratorFor(items)\n  }\n\n  if (support.iterable) {\n    Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result)\n      }\n      reader.onerror = function() {\n        reject(reader.error)\n      }\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader()\n    var promise = fileReaderReady(reader)\n    reader.readAsArrayBuffer(blob)\n    return promise\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader()\n    var promise = fileReaderReady(reader)\n    reader.readAsText(blob)\n    return promise\n  }\n\n  function readArrayBufferAsText(buf) {\n    var view = new Uint8Array(buf)\n    var chars = new Array(view.length)\n\n    for (var i = 0; i < view.length; i++) {\n      chars[i] = String.fromCharCode(view[i])\n    }\n    return chars.join('')\n  }\n\n  function bufferClone(buf) {\n    if (buf.slice) {\n      return buf.slice(0)\n    } else {\n      var view = new Uint8Array(buf.byteLength)\n      view.set(new Uint8Array(buf))\n      return view.buffer\n    }\n  }\n\n  function Body() {\n    this.bodyUsed = false\n\n    this._initBody = function(body) {\n      this._bodyInit = body\n      if (!body) {\n        this._bodyText = ''\n      } else if (typeof body === 'string') {\n        this._bodyText = body\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this._bodyText = body.toString()\n      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n        this._bodyArrayBuffer = bufferClone(body.buffer)\n        // IE 10-11 can't handle a DataView body.\n        this._bodyInit = new Blob([this._bodyArrayBuffer])\n      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n        this._bodyArrayBuffer = bufferClone(body)\n      } else {\n        throw new Error('unsupported BodyInit type')\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8')\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type)\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n        }\n      }\n    }\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this)\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyArrayBuffer) {\n          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      }\n\n      this.arrayBuffer = function() {\n        if (this._bodyArrayBuffer) {\n          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n        } else {\n          return this.blob().then(readBlobAsArrayBuffer)\n        }\n      }\n    }\n\n    this.text = function() {\n      var rejected = consumed(this)\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return readBlobAsText(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as text')\n      } else {\n        return Promise.resolve(this._bodyText)\n      }\n    }\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      }\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    }\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase()\n    return (methods.indexOf(upcased) > -1) ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {}\n    var body = options.body\n\n    if (input instanceof Request) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url\n      this.credentials = input.credentials\n      if (!options.headers) {\n        this.headers = new Headers(input.headers)\n      }\n      this.method = input.method\n      this.mode = input.mode\n      if (!body && input._bodyInit != null) {\n        body = input._bodyInit\n        input.bodyUsed = true\n      }\n    } else {\n      this.url = String(input)\n    }\n\n    this.credentials = options.credentials || this.credentials || 'omit'\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers)\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET')\n    this.mode = options.mode || this.mode || null\n    this.referrer = null\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body)\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this, { body: this._bodyInit })\n  }\n\n  function decode(body) {\n    var form = new FormData()\n    body.trim().split('&').forEach(function(bytes) {\n      if (bytes) {\n        var split = bytes.split('=')\n        var name = split.shift().replace(/\\+/g, ' ')\n        var value = split.join('=').replace(/\\+/g, ' ')\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\n      }\n    })\n    return form\n  }\n\n  function parseHeaders(rawHeaders) {\n    var headers = new Headers()\n    // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\n    // https://tools.ietf.org/html/rfc7230#section-3.2\n    var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ')\n    preProcessedHeaders.split(/\\r?\\n/).forEach(function(line) {\n      var parts = line.split(':')\n      var key = parts.shift().trim()\n      if (key) {\n        var value = parts.join(':').trim()\n        headers.append(key, value)\n      }\n    })\n    return headers\n  }\n\n  Body.call(Request.prototype)\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {}\n    }\n\n    this.type = 'default'\n    this.status = options.status === undefined ? 200 : options.status\n    this.ok = this.status >= 200 && this.status < 300\n    this.statusText = 'statusText' in options ? options.statusText : 'OK'\n    this.headers = new Headers(options.headers)\n    this.url = options.url || ''\n    this._initBody(bodyInit)\n  }\n\n  Body.call(Response.prototype)\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  }\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''})\n    response.type = 'error'\n    return response\n  }\n\n  var redirectStatuses = [301, 302, 303, 307, 308]\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  }\n\n  self.Headers = Headers\n  self.Request = Request\n  self.Response = Response\n\n  self.fetch = function(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request = new Request(input, init)\n      var xhr = new XMLHttpRequest()\n\n      xhr.onload = function() {\n        var options = {\n          status: xhr.status,\n          statusText: xhr.statusText,\n          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n        }\n        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL')\n        var body = 'response' in xhr ? xhr.response : xhr.responseText\n        resolve(new Response(body, options))\n      }\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.ontimeout = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.open(request.method, request.url, true)\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true\n      } else if (request.credentials === 'omit') {\n        xhr.withCredentials = false\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob'\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value)\n      })\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n    })\n  }\n  self.fetch.polyfill = true\n})(typeof self !== 'undefined' ? self : this);\n","import promiseFinally from './finally';\n\n// Store setTimeout reference so promise-polyfill will be unaffected by\n// other code modifying setTimeout (like sinon.useFakeTimers())\nvar setTimeoutFunc = setTimeout;\n\nfunction noop() {}\n\n// Polyfill for Function.prototype.bind\nfunction bind(fn, thisArg) {\n  return function() {\n    fn.apply(thisArg, arguments);\n  };\n}\n\n/**\n * @constructor\n * @param {Function} fn\n */\nfunction Promise(fn) {\n  if (!(this instanceof Promise))\n    throw new TypeError('Promises must be constructed via new');\n  if (typeof fn !== 'function') throw new TypeError('not a function');\n  /** @type {!number} */\n  this._state = 0;\n  /** @type {!boolean} */\n  this._handled = false;\n  /** @type {Promise|undefined} */\n  this._value = undefined;\n  /** @type {!Array<!Function>} */\n  this._deferreds = [];\n\n  doResolve(fn, this);\n}\n\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (self._state === 0) {\n    self._deferreds.push(deferred);\n    return;\n  }\n  self._handled = true;\n  Promise._immediateFn(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n      return;\n    }\n    var ret;\n    try {\n      ret = cb(self._value);\n    } catch (e) {\n      reject(deferred.promise, e);\n      return;\n    }\n    resolve(deferred.promise, ret);\n  });\n}\n\nfunction resolve(self, newValue) {\n  try {\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    if (newValue === self)\n      throw new TypeError('A promise cannot be resolved with itself.');\n    if (\n      newValue &&\n      (typeof newValue === 'object' || typeof newValue === 'function')\n    ) {\n      var then = newValue.then;\n      if (newValue instanceof Promise) {\n        self._state = 3;\n        self._value = newValue;\n        finale(self);\n        return;\n      } else if (typeof then === 'function') {\n        doResolve(bind(then, newValue), self);\n        return;\n      }\n    }\n    self._state = 1;\n    self._value = newValue;\n    finale(self);\n  } catch (e) {\n    reject(self, e);\n  }\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction finale(self) {\n  if (self._state === 2 && self._deferreds.length === 0) {\n    Promise._immediateFn(function() {\n      if (!self._handled) {\n        Promise._unhandledRejectionFn(self._value);\n      }\n    });\n  }\n\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\n    handle(self, self._deferreds[i]);\n  }\n  self._deferreds = null;\n}\n\n/**\n * @constructor\n */\nfunction Handler(onFulfilled, onRejected, promise) {\n  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n  this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, self) {\n  var done = false;\n  try {\n    fn(\n      function(value) {\n        if (done) return;\n        done = true;\n        resolve(self, value);\n      },\n      function(reason) {\n        if (done) return;\n        done = true;\n        reject(self, reason);\n      }\n    );\n  } catch (ex) {\n    if (done) return;\n    done = true;\n    reject(self, ex);\n  }\n}\n\nPromise.prototype['catch'] = function(onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  // @ts-ignore\n  var prom = new this.constructor(noop);\n\n  handle(this, new Handler(onFulfilled, onRejected, prom));\n  return prom;\n};\n\nPromise.prototype['finally'] = promiseFinally;\n\nPromise.all = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!arr || typeof arr.length === 'undefined')\n      throw new TypeError('Promise.all accepts an array');\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      try {\n        if (val && (typeof val === 'object' || typeof val === 'function')) {\n          var then = val.then;\n          if (typeof then === 'function') {\n            then.call(\n              val,\n              function(val) {\n                res(i, val);\n              },\n              reject\n            );\n            return;\n          }\n        }\n        args[i] = val;\n        if (--remaining === 0) {\n          resolve(args);\n        }\n      } catch (ex) {\n        reject(ex);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.resolve = function(value) {\n  if (value && typeof value === 'object' && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function(value) {\n  return new Promise(function(resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function(values) {\n  return new Promise(function(resolve, reject) {\n    for (var i = 0, len = values.length; i < len; i++) {\n      values[i].then(resolve, reject);\n    }\n  });\n};\n\n// Use polyfill for setImmediate for performance gains\nPromise._immediateFn =\n  (typeof setImmediate === 'function' &&\n    function(fn) {\n      setImmediate(fn);\n    }) ||\n  function(fn) {\n    setTimeoutFunc(fn, 0);\n  };\n\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n  if (typeof console !== 'undefined' && console) {\n    console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console\n  }\n};\n\nexport default Promise;\n","module.exports = {\n  map: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\n  encode: function (n) {\n    \"use strict\";\n    var o = \"\", i = 0, m = this.map, i1, i2, i3, e1, e2, e3, e4;\n    n = this.utf8.encode(n);\n    while (i < n.length) {\n      i1 = n.charCodeAt(i++); i2 = n.charCodeAt(i++); i3 = n.charCodeAt(i++);\n      e1 = (i1 >> 2); e2 = (((i1 & 3) << 4) | (i2 >> 4)); e3 = (isNaN(i2) ? 64 : ((i2 & 15) << 2) | (i3 >> 6));\n      e4 = (isNaN(i2) || isNaN(i3)) ? 64 : i3 & 63;\n      o = o + m.charAt(e1) + m.charAt(e2) + m.charAt(e3) + m.charAt(e4);\n    } return o;\n  },\n  decode: function (n) {\n    \"use strict\";\n    var o = \"\", i = 0, m = this.map, cc = String.fromCharCode, e1, e2, e3, e4, c1, c2, c3;\n    n = n.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n    while (i < n.length) {\n      e1 = m.indexOf(n.charAt(i++)); e2 = m.indexOf(n.charAt(i++));\n      e3 = m.indexOf(n.charAt(i++)); e4 = m.indexOf(n.charAt(i++));\n      c1 = (e1 << 2) | (e2 >> 4); c2 = ((e2 & 15) << 4) | (e3 >> 2);\n      c3 = ((e3 & 3) << 6) | e4;\n      o = o + (cc(c1) + ((e3 != 64) ? cc(c2) : \"\")) + (((e4 != 64) ? cc(c3) : \"\"));\n    } return this.utf8.decode(o);\n  },\n  utf8: {\n    encode: function (n) {\n      \"use strict\";\n      var o = \"\", i = 0, cc = String.fromCharCode, c;\n      while (i < n.length) {\n        c = n.charCodeAt(i++); o = o + ((c < 128) ? cc(c) : ((c > 127) && (c < 2048)) ?\n        (cc((c >> 6) | 192) + cc((c & 63) | 128)) : (cc((c >> 12) | 224) + cc(((c >> 6) & 63) | 128) + cc((c & 63) | 128)));\n        } return o;\n    },\n    decode: function (n) {\n      \"use strict\";\n      var o = \"\", i = 0, cc = String.fromCharCode, c2, c;\n      while (i < n.length) {\n        c = n.charCodeAt(i);\n        o = o + ((c < 128) ? [cc(c), i++][0] : ((c > 191) && (c < 224)) ?\n        [cc(((c & 31) << 6) | ((c2 = n.charCodeAt(i + 1)) & 63)), (i += 2)][0] :\n        [cc(((c & 15) << 12) | (((c2 = n.charCodeAt(i + 1)) & 63) << 6) | ((c3 = n.charCodeAt(i + 2)) & 63)), (i += 3)][0]);\n      } return o;\n    }\n  }\n};\n","module.exports = parseParams;\n\nfunction parseParams(str){\n  // via: http://stackoverflow.com/a/2880929/2511985\n  var urlParams = {},\n      match,\n      pl     = /\\+/g,  // Regex for replacing addition symbol with a space\n      search = /([^&=]+)=?([^&]*)/g,\n      decode = function (s) { return decodeURIComponent(s.replace(pl, \" \")); },\n      query  = str.split(\"?\")[1];\n\n  while (!!(match=search.exec(query))) {\n    urlParams[decode(match[1])] = decode(match[2]);\n  }\n  return urlParams;\n};\n","var each = require('./each'),\n    extend = require('./extend');\n\nmodule.exports = serialize;\n\nfunction serialize(data){\n  var query = [];\n  each(data, function(value, key){\n    if ('string' !== typeof value) {\n      value = JSON.stringify(value);\n    }\n    query.push(key + '=' + encodeURIComponent(value));\n  });\n  return query.join('&');\n}\n","var scope = (typeof global !== \"undefined\" && global) ||\n            (typeof self !== \"undefined\" && self) ||\n            window;\nvar apply = Function.prototype.apply;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, scope, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, scope, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(scope, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// setimmediate attaches itself to the global object\nrequire(\"setimmediate\");\n// On some exotic environments, it's not clear which object `setimmediate` was\n// able to install onto.  Search each possibility in the same order as the\n// `setimmediate` library.\nexports.setImmediate = (typeof self !== \"undefined\" && self.setImmediate) ||\n                       (typeof global !== \"undefined\" && global.setImmediate) ||\n                       (this && this.setImmediate);\nexports.clearImmediate = (typeof self !== \"undefined\" && self.clearImmediate) ||\n                         (typeof global !== \"undefined\" && global.clearImmediate) ||\n                         (this && this.clearImmediate);\n","(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 68\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","export const configDefault = {\r\n\r\n  // defer events - queue\r\n  // https://github.com/keen/keen-tracking.js/blob/master/docs/defer-events.md\r\n  queue: {\r\n    capacity: 5000,\r\n    interval: 15,\r\n  },\r\n\r\n  // connection problems - retry request\r\n  retry: {\r\n    limit: 10,\r\n    initialDelay: 200,\r\n    retryOnResponseStatuses: [\r\n      408,\r\n      500,\r\n      502,\r\n      503,\r\n      504\r\n    ]\r\n  },\r\n\r\n  unique: false, // record only unique events?\r\n  // if so - store unique events hashes to compare\r\n  cache: {\r\n    /*\r\n      storage: 'indexeddb', // uncomment for persistence\r\n    */\r\n    dbName: 'keenTracking', // indexedDB name\r\n    dbCollectionName: 'events',\r\n    dbCollectionKey: 'hash',\r\n\r\n    /*\r\n      hashingMethod: 'md5', // if undefined - store as stringified JSON\r\n    */\r\n    maxAge: 60 * 1000, // store for 1 minute\r\n  }\r\n}\r\n\r\nexport default configDefault;\r\n","import Emitter from 'component-emitter';\r\n\r\nimport configDefault from '../config-default.js';\r\n\r\nexport function queue(configQueue = {}) {\r\n  if (this instanceof queue === false) {\r\n    return new queue(configQueue);\r\n  }\r\n  this.capacity = 0;\r\n  this.config = {\r\n    ...configDefault.queue,\r\n    ...configQueue\r\n  };\r\n  this.events = {\r\n    // \"collection-1\": [],\r\n    // \"collection-2\": []\r\n  };\r\n  this.interval = 0;\r\n  this.timer = null;\r\n  return this;\r\n}\r\n\r\nEmitter(queue.prototype);\r\n\r\nqueue.prototype.check = function() {\r\n  if (shouldFlushQueue(this)) {\r\n    this.flush();\r\n  }\r\n  if (this.config.interval === 0 || this.capacity === 0) {\r\n    this.pause();\r\n  }\r\n  return this;\r\n};\r\n\r\nqueue.prototype.flush = function() {\r\n  this.emit('flush');\r\n  this.interval = 0;\r\n  return this;\r\n};\r\n\r\nqueue.prototype.pause = function() {\r\n  if (this.timer) {\r\n    clearInterval(this.timer);\r\n    this.timer = null;\r\n  }\r\n  return this;\r\n};\r\n\r\nqueue.prototype.start = function() {\r\n  var self = this;\r\n  self.pause();\r\n  self.timer = setInterval(function() {\r\n    self.interval++;\r\n    self.check();\r\n  }, 1000);\r\n  return self;\r\n};\r\n\r\nfunction shouldFlushQueue(props) {\r\n  if (props.capacity > 0 && props.interval >= props.config.interval) {\r\n    return true;\r\n  }\r\n  else if (props.capacity >= props.config.capacity) {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n","import KeenCore from 'keen-core';\r\nimport each from 'keen-core/lib/utils/each';\r\nimport extend from 'keen-core/lib/utils/extend';\r\nimport { queue } from'./utils/queue';\r\n\r\nKeenCore.helpers = KeenCore.helpers || {};\r\n\r\n// Install internal queue\r\nKeenCore.on('client', function(client){\r\n  client.extensions = {\r\n    events: [],\r\n    collections: {}\r\n  };\r\n  client.queue = queue(client.config.queue);\r\n  client.queue.on('flush', function(){\r\n    client.recordDeferredEvents();\r\n  });\r\n});\r\n\r\n// Accessors\r\nKeenCore.prototype.writeKey = function(str){\r\n  if (!arguments.length) return this.config.writeKey;\r\n  this.config.writeKey = (str ? String(str) : null);\r\n  return this;\r\n};\r\n\r\nKeenCore.prototype.referrerPolicy = function(str){\r\n  if (!arguments.length) return this.config.referrerPolicy;\r\n  this.config.referrerPolicy = (str ? String(str) : null);\r\n  return this;\r\n};\r\n\r\n// DEPRECATED\r\nKeenCore.prototype.setGlobalProperties = function(props){\r\n  KeenCore.log('This method has been removed. Check out #extendEvents: https://github.com/keen/keen-tracking.js#extend-events');\r\n  return this;\r\n};\r\n\r\nexport default KeenCore;\r\n","import Emitter from 'component-emitter';\r\nimport each from 'keen-core/lib/utils/each';\r\n/*\r\n\r\n  // Create a new element listner\r\n  var myClickerCatcher = Keen.utils.listener(\".nav li > a\");\r\n\r\n  // Listen for a given event\r\n  myClicker.on(\"click\", function(e){\r\n    // do stuff!\r\n  });\r\n\r\n  // Listen for event once\r\n  myClicker.once(\"click\", function(e){ });\r\n\r\n  // Cancel a given event listener\r\n  myClicker.off(\"click\");\r\n\r\n  // Cancel all event listners\r\n  myClicker.off();\r\n\r\n*/\r\n\r\nexport const listenerCore = function(ctx){\r\n\r\n  // Make sure this object exists\r\n  ctx.domListeners = ctx.domListeners || {\r\n    /*\r\n    'click': {\r\n      '.nav li > a': [fn, fn, fn]\r\n    }\r\n    */\r\n  };\r\n\r\n  function listener(str){\r\n    if (!str) return;\r\n    if (this instanceof listener === false) {\r\n      return new listener(str);\r\n    }\r\n    this.selector = str;\r\n    return this;\r\n  }\r\n\r\n  listener.prototype.on = function(str, fn){\r\n    var self = this;\r\n\r\n    if (arguments.length !== 2 || 'string' !== typeof str || 'function' !== typeof fn) return this;\r\n\r\n    // Set each listener on a parent dictionary, indexed by event:\r\n    if ('undefined' === typeof ctx.domListeners[str]) {\r\n      addListener(str, eventHandler(str));\r\n      ctx.domListeners[str] = {};\r\n    }\r\n    ctx.domListeners[str][self.selector] = ctx.domListeners[str][self.selector] || [];\r\n    ctx.domListeners[str][self.selector].push(fn);\r\n    return self;\r\n  };\r\n\r\n  listener.prototype.once = function(str, fn){\r\n    var self = this;\r\n    function on() {\r\n      self.off(str, on);\r\n      return fn.apply(self, arguments);\r\n    }\r\n    on.fn = fn;\r\n    self.on(str, on);\r\n    return self;\r\n  };\r\n\r\n  listener.prototype.off = function(str, fn){\r\n    var self = this, survivors = [];\r\n    if (arguments.length === 2) {\r\n      each(ctx.domListeners[str][self.selector], function(handler, i){\r\n        if (handler === fn || handler.fn === fn) return;\r\n        survivors.push(handler);\r\n      });\r\n      ctx.domListeners[str][self.selector] = survivors;\r\n    }\r\n    else if (arguments.length === 1) {\r\n      try {\r\n        delete ctx.domListeners[str][self.selector];\r\n      }\r\n      catch(e){\r\n        ctx.domListeners[str][self.selector] = [];\r\n      }\r\n    }\r\n    else {\r\n      // loop over every eventType and delete handlers\r\n      each(ctx.domListeners, function(hash, eventType){\r\n        // if ('undefined' === typeof hash[str]) return;\r\n        try {\r\n          delete ctx.domListeners[eventType][self.selector];\r\n        }\r\n        catch(e){\r\n          ctx.domListeners[eventType][self.selector] = function(){};\r\n        }\r\n      });\r\n    }\r\n    return self;\r\n  };\r\n\r\n  function eventHandler(eventType){\r\n    return function(e){\r\n      var evt, target;\r\n\r\n      evt = e || window.event;\r\n      target = evt.target || evt.srcElement;\r\n\r\n      // If nothing assigned to this event type, let it go\r\n      if ('undefined' === ctx.domListeners[eventType]) return;\r\n\r\n      each(ctx.domListeners[eventType], function(handlers, key){\r\n\r\n        if (matches(target, key)) {\r\n          // Call all handlers for this eventType + node\r\n          each(handlers, function(fn, i){\r\n            fn(evt);\r\n          });\r\n        }\r\n        else if ('window' === key) {\r\n          // Call all handlers\r\n          each(handlers, function(fn, i){\r\n            fn(evt);\r\n          });\r\n        }\r\n        return;\r\n      });\r\n    };\r\n  }\r\n\r\n  return listener;\r\n}\r\n\r\n\r\n// ------------------------------\r\n// Attach global event listener\r\n// ------------------------------\r\n\r\nfunction addListener(eventType, fn){\r\n  if (document.addEventListener) {\r\n    document.addEventListener(eventType, fn, false);\r\n  } else {\r\n    document.attachEvent(\"on\" + eventType, fn);\r\n  }\r\n}\r\n\r\n\r\n// ------------------------------\r\n// Match DOM element to selector\r\n// ------------------------------\r\n\r\nfunction matches(elem, selector) {\r\n  // We'll use querySelectorAll to find all element matching the selector,\r\n  // then check if the given element is included in that list.\r\n  // Executing the query on the parentNode reduces the resulting nodeList,\r\n  // document doesn't have a parentNode, though.\r\n  var nodeList = ( elem.parentNode || document ).querySelectorAll( selector ) || [],\r\n      i = nodeList.length;\r\n\r\n  // loop on the nodeList\r\n  while ( i-- ) {\r\n    if ( nodeList[i] == elem ) { return true; }\r\n  }\r\n  return false;\r\n}\r\n","export const deepExtend = function(target){\r\n  for (var i = 1; i < arguments.length; i++) {\r\n    // Copy unique items from incoming array\r\n    if (target instanceof Array && arguments[i] instanceof Array) {\r\n      for (var j = 0; j < arguments[i].length; j++) {\r\n        if (target.indexOf(arguments[i][j]) < 0) {\r\n          target.push(arguments[i][j]);\r\n        }\r\n      }\r\n    }\r\n    // Blend objects\r\n    else {\r\n      for (var prop in arguments[i]){\r\n        // Recurse when both contain objects of same name\r\n        // and incoming is not a null object\r\n        if (typeof target[prop] !== 'undefined'\r\n          && typeof arguments[i][prop] === 'object'\r\n          && arguments[i][prop] !== null) {\r\n            deepExtend(target[prop], clone(arguments[i][prop]));\r\n        }\r\n        // Otherwise just copy it over...\r\n        else if (\r\n          arguments[i][prop] !== undefined &&\r\n          typeof arguments[i][prop] !== 'function') {\r\n            target[prop] = clone(arguments[i][prop]);\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return target;\r\n}\r\n\r\nfunction clone(input){\r\n  return JSON.parse( JSON.stringify(input) );\r\n}\r\n","import { deepExtend } from './utils/deepExtend';\r\nimport each from 'keen-core/lib/utils/each';\r\n\r\nexport function extendEvent(eventCollection, eventModifier){\r\n  if (arguments.length !== 2 || typeof eventCollection !== 'string'\r\n    || ('object' !== typeof eventModifier && 'function' !== typeof eventModifier)) {\r\n      handleValidationError.call(this, 'Incorrect arguments provided to #extendEvent method');\r\n      return;\r\n  }\r\n  this.extensions.collections[eventCollection] = this.extensions.collections[eventCollection] || [];\r\n  this.extensions.collections[eventCollection].push(eventModifier);\r\n  this.emit('extendEvent', eventCollection, eventModifier);\r\n  return this;\r\n}\r\n\r\nexport function extendEvents(eventsModifier){\r\n  if (arguments.length !== 1 || ('object' !== typeof eventsModifier && 'function' !== typeof eventsModifier)) {\r\n    handleValidationError.call(this, 'Incorrect arguments provided to #extendEvents method');\r\n    return;\r\n  }\r\n  this.extensions.events.push(eventsModifier);\r\n  this.emit('extendEvents', eventsModifier);\r\n  return this;\r\n}\r\n\r\nfunction handleValidationError(message){\r\n  this.emit('error', `Event(s) not extended: ${message}`);\r\n}\r\n\r\nexport function getExtendedEventBody(result, queue){\r\n  if (queue && queue.length > 0) {\r\n    each(queue, function(eventModifier, i){\r\n      let modifierResult = (typeof eventModifier === 'function') ? eventModifier() : eventModifier;\r\n      deepExtend(result, modifierResult);\r\n    });\r\n  }\r\n  return result;\r\n}\r\n","import 'promise-polyfill/src/polyfill';\r\nimport 'whatwg-fetch';\r\n\r\nimport configDefault from '../config-default.js';\r\n\r\nexport default function(url, options) {\r\n  const config = {\r\n    ...configDefault,\r\n    ...(options.retry || {})\r\n  };\r\n\r\n  const retriesLimit = config.retry.limit;\r\n  const retryInitialDelay = config.retry.initialDelay;\r\n  const retryOn = config.retry.retryOnResponseStatuses;\r\n  let retriesCount = 0;\r\n\r\n  if (retryOn && !(retryOn instanceof Array)) {\r\n    throw {\r\n      name: 'ArgumentError',\r\n      message: 'retryOn property expects an array'\r\n    }\r\n  }\r\n\r\n  return new Promise(function(resolve, reject) {\r\n    const wrappedFetch = function(n) {\r\n      fetch(url, options)\r\n        .then(function(response) {\r\n          if (retryOn.indexOf(response.status) === -1) {\r\n            resolve(response);\r\n          } else {\r\n            if (n > 0) {\r\n              retry();\r\n            } else {\r\n              reject(response);\r\n            }\r\n          }\r\n        })\r\n        .catch(function(error) {\r\n          if (n > 0) {\r\n            retry();\r\n          } else {\r\n            reject(error);\r\n          }\r\n        });\r\n    };\r\n\r\n    function retry() {\r\n      retriesCount = retriesCount + 1;\r\n      setTimeout(function() {\r\n          wrappedFetch(retriesLimit - retriesCount);\r\n        }, 2^retriesCount * retryInitialDelay);\r\n    }\r\n\r\n    wrappedFetch(retriesLimit - retriesCount);\r\n  });\r\n};\r\n","export const MD5 = function(d){const result = M(V(Y(X(d),8*d.length)));return result.toLowerCase()};function M(d){for(var _,m=\"0123456789ABCDEF\",f=\"\",r=0;r<d.length;r++)_=d.charCodeAt(r),f+=m.charAt(_>>>4&15)+m.charAt(15&_);return f}function X(d){for(var _=Array(d.length>>2),m=0;m<_.length;m++)_[m]=0;for(m=0;m<8*d.length;m+=8)_[m>>5]|=(255&d.charCodeAt(m/8))<<m%32;return _}function V(d){for(var _=\"\",m=0;m<32*d.length;m+=8)_+=String.fromCharCode(d[m>>5]>>>m%32&255);return _}function Y(d,_){d[_>>5]|=128<<_%32,d[14+(_+64>>>9<<4)]=_;for(var m=1732584193,f=-271733879,r=-1732584194,i=271733878,n=0;n<d.length;n+=16){var h=m,t=f,g=r,e=i;f=md5_ii(f=md5_ii(f=md5_ii(f=md5_ii(f=md5_hh(f=md5_hh(f=md5_hh(f=md5_hh(f=md5_gg(f=md5_gg(f=md5_gg(f=md5_gg(f=md5_ff(f=md5_ff(f=md5_ff(f=md5_ff(f,r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+0],7,-680876936),f,r,d[n+1],12,-389564586),m,f,d[n+2],17,606105819),i,m,d[n+3],22,-1044525330),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+4],7,-176418897),f,r,d[n+5],12,1200080426),m,f,d[n+6],17,-1473231341),i,m,d[n+7],22,-45705983),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+8],7,1770035416),f,r,d[n+9],12,-1958414417),m,f,d[n+10],17,-42063),i,m,d[n+11],22,-1990404162),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+12],7,1804603682),f,r,d[n+13],12,-40341101),m,f,d[n+14],17,-1502002290),i,m,d[n+15],22,1236535329),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+1],5,-165796510),f,r,d[n+6],9,-1069501632),m,f,d[n+11],14,643717713),i,m,d[n+0],20,-373897302),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+5],5,-701558691),f,r,d[n+10],9,38016083),m,f,d[n+15],14,-660478335),i,m,d[n+4],20,-405537848),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+9],5,568446438),f,r,d[n+14],9,-1019803690),m,f,d[n+3],14,-187363961),i,m,d[n+8],20,1163531501),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+13],5,-1444681467),f,r,d[n+2],9,-51403784),m,f,d[n+7],14,1735328473),i,m,d[n+12],20,-1926607734),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+5],4,-378558),f,r,d[n+8],11,-2022574463),m,f,d[n+11],16,1839030562),i,m,d[n+14],23,-35309556),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+1],4,-1530992060),f,r,d[n+4],11,1272893353),m,f,d[n+7],16,-155497632),i,m,d[n+10],23,-1094730640),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+13],4,681279174),f,r,d[n+0],11,-358537222),m,f,d[n+3],16,-722521979),i,m,d[n+6],23,76029189),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+9],4,-640364487),f,r,d[n+12],11,-421815835),m,f,d[n+15],16,530742520),i,m,d[n+2],23,-995338651),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+0],6,-198630844),f,r,d[n+7],10,1126891415),m,f,d[n+14],15,-1416354905),i,m,d[n+5],21,-57434055),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+12],6,1700485571),f,r,d[n+3],10,-1894986606),m,f,d[n+10],15,-1051523),i,m,d[n+1],21,-2054922799),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+8],6,1873313359),f,r,d[n+15],10,-30611744),m,f,d[n+6],15,-1560198380),i,m,d[n+13],21,1309151649),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+4],6,-145523070),f,r,d[n+11],10,-1120210379),m,f,d[n+2],15,718787259),i,m,d[n+9],21,-343485551),m=safe_add(m,h),f=safe_add(f,t),r=safe_add(r,g),i=safe_add(i,e)}return Array(m,f,r,i)}function md5_cmn(d,_,m,f,r,i){return safe_add(bit_rol(safe_add(safe_add(_,d),safe_add(f,i)),r),m)}function md5_ff(d,_,m,f,r,i,n){return md5_cmn(_&m|~_&f,d,_,r,i,n)}function md5_gg(d,_,m,f,r,i,n){return md5_cmn(_&f|m&~f,d,_,r,i,n)}function md5_hh(d,_,m,f,r,i,n){return md5_cmn(_^m^f,d,_,r,i,n)}function md5_ii(d,_,m,f,r,i,n){return md5_cmn(m^(_|~f),d,_,r,i,n)}function safe_add(d,_){var m=(65535&d)+(65535&_);return(d>>16)+(_>>16)+(m>>16)<<16|65535&m}function bit_rol(d,_){return d<<_|d>>>32-_}\r\n\r\nexport default MD5;\r\n","import 'promise-polyfill/src/polyfill';\r\nimport 'whatwg-fetch';\r\n\r\nimport md5 from './md5';\r\n\r\nimport configDefault from '../config-default.js';\r\n\r\nif (typeof self === 'undefined') {\r\n  throw 'IndexedDB is available only in Browser ENV';\r\n}\r\n\r\nconst indexedDBAvailable = 'indexedDB' in self;\r\nlet cachingEnabled = true;\r\n\r\nif (!indexedDBAvailable) {\r\n    // console.log(\"Your browser doesn't support a stable version of IndexedDB.\");\r\n    cachingEnabled = false; // graceful degradation\r\n}\r\n\r\nlet db;\r\nlet cacheConfig = {\r\n  ...configDefault.cache\r\n};\r\n\r\nfunction initializeIndexedDb(requestCacheConfig = {}){\r\n  if (db) { return Promise.resolve(); }\r\n  if (!cachingEnabled) { return Promise.resolve(); }\r\n  cacheConfig = {\r\n    ...cacheConfig,\r\n    ...requestCacheConfig\r\n  };\r\n  return new Promise((resolve, reject) => {\r\n    const dbConnectionRequest = self.indexedDB.open(cacheConfig.dbName);\r\n    dbConnectionRequest.onerror = function(event) {\r\n      cachingEnabled = false;\r\n      resolve();\r\n    };\r\n\r\n    dbConnectionRequest.onupgradeneeded = function(event) {\r\n      const db = event.target.result;\r\n      const objectStore = db\r\n        .createObjectStore(cacheConfig.dbCollectionName,\r\n          { keyPath: cacheConfig.dbCollectionKey });\r\n      objectStore.createIndex(\r\n        cacheConfig.dbCollectionKey,\r\n        cacheConfig.dbCollectionKey,\r\n        { unique: true }\r\n      );\r\n      objectStore.createIndex('expiryTime', 'expiryTime', { unique: false });\r\n    };\r\n\r\n    dbConnectionRequest.onsuccess = function(event) {\r\n      db = event.target.result;\r\n      db.onerror = function(event) {\r\n        cachingEnabled = false; // graceful degradation\r\n      };\r\n      resolve(db);\r\n    };\r\n  });\r\n}\r\n\r\nexport const saveToCache = (hash, configOptions = {}) => {\r\n  return initializeIndexedDb(configOptions).then(() => {\r\n    const transactionSave = db\r\n      .transaction(cacheConfig.dbCollectionName, \"readwrite\")\r\n      .objectStore(cacheConfig.dbCollectionName);\r\n    const requestSave = transactionSave.add({\r\n      hash,\r\n      expiryTime: Date.now() + cacheConfig.maxAge\r\n    });\r\n    requestSave.onsuccess = function(event) {\r\n    };\r\n    requestSave.onerror = function(event) {\r\n      cachingEnabled = false;\r\n    };\r\n  });\r\n}\r\n\r\nexport const getFromCache = (hash, configOptions = {}) => {\r\n  return initializeIndexedDb(configOptions).then(() => {\r\n    return new Promise((resolve, reject) => {\r\n      if (!cachingEnabled) {\r\n        return resolve(null);\r\n      }\r\n\r\n      const transactionCleanUp = db\r\n        .transaction(cacheConfig.dbCollectionName, \"readwrite\")\r\n        .objectStore(cacheConfig.dbCollectionName);\r\n      const indexCleanUp = transactionCleanUp.index('expiryTime');\r\n      const upperBoundOpenKeyRange = IDBKeyRange.upperBound(Date.now(), true);\r\n      indexCleanUp.openCursor(upperBoundOpenKeyRange).onsuccess = function(event) {\r\n        let cursor = event.target.result;\r\n        if (cursor) {\r\n          let transactionDelete = db\r\n            .transaction(cacheConfig.dbCollectionName, \"readwrite\")\r\n            .objectStore(cacheConfig.dbCollectionName)\r\n            .delete(event.target.result.value[cacheConfig.dbCollectionKey]);\r\n          cursor.continue();\r\n        }\r\n      };\r\n\r\n      const transactionIndex = db\r\n        .transaction(cacheConfig.dbCollectionName, \"readwrite\")\r\n        .objectStore(cacheConfig.dbCollectionName);\r\n      const index = transactionIndex.index(cacheConfig.dbCollectionKey);\r\n      const responseFromCache = index.get(hash);\r\n      responseFromCache.onsuccess = function(event) {\r\n        if (!event.target.result ||\r\n          event.target.result.expiryTime < Date.now()\r\n        ) {\r\n          if (event.target.result && event.target.result.expiryTime < Date.now()){\r\n            const transactionDelete = db\r\n              .transaction(cacheConfig.dbCollectionName, \"readwrite\")\r\n              .objectStore(cacheConfig.dbCollectionName)\r\n              .delete(event.target.result[cacheConfig.dbCollectionKey]);\r\n            transactionDelete.onsuccess = (event) => {\r\n              resolve(getFromCache(hash, configOptions));\r\n            };\r\n            transactionDelete.onerror = (event) => {\r\n              cachingEnabled = false;\r\n              resolve(getFromCache(hash, configOptions));\r\n            };\r\n            return resolve(null);\r\n          }\r\n          return resolve(null);\r\n        } else {\r\n          return resolve(event.target.result);\r\n        }\r\n      };\r\n      responseFromCache.onerror = function(event) {\r\n        cachingEnabled = false;\r\n        resolve(getFromCache(hash, configOptions));\r\n      };\r\n    });\r\n  });\r\n}\r\n","import 'promise-polyfill/src/polyfill';\r\n\r\nimport md5 from './md5';\r\nimport { getFromCache, saveToCache } from './cache-browser';\r\n\r\nimport configDefault from '../config-default.js';\r\n\r\nlet uniqueIds = [];\r\n\r\nexport const isUnique = (customCacheConfig, extendedEventBody) => {\r\n  const configCache = { ...configDefault.cache, ...customCacheConfig.cache };\r\n  const stringifiedEvent = JSON.stringify(extendedEventBody);\r\n  const { hashingMethod } = configCache;\r\n  const hash = hashingMethod && hashingMethod.toLowerCase() === 'md5'\r\n    ? md5(stringifiedEvent) : stringifiedEvent;\r\n  const expiryTime = configCache.maxAge ? (Date.now() + configCache.maxAge) : undefined;\r\n  const item = {\r\n    hash,\r\n    expiryTime\r\n  };\r\n  if (expiryTime){\r\n    const now = Date.now();\r\n    uniqueIds = uniqueIds.filter(item => item.expiryTime > now);\r\n  }\r\n\r\n  const alreadySentEvent = uniqueIds.find(item => item.hash === hash);\r\n  if (alreadySentEvent) {\r\n    if (alreadySentEvent.expiryTime && alreadySentEvent.expiryTime < Date.now()) {\r\n      uniqueIds = uniqueIds.filter(item => item.hash !== hash);\r\n    } else {\r\n      return Promise.resolve(false);\r\n    }\r\n  }\r\n  uniqueIds.push(item);\r\n  if (configCache.storage && configCache.storage.toLowerCase() === 'indexeddb') {\r\n    return getFromCache(hash, configCache).then(alreadySentEvent => {\r\n      if (alreadySentEvent) {\r\n        return false;\r\n      }\r\n      saveToCache(hash, configCache);\r\n      return true;\r\n    });\r\n  }\r\n\r\n  return Promise.resolve(true);\r\n}\r\n\r\nexport default isUnique;\r\n","import 'promise-polyfill/src/polyfill';\r\nimport 'whatwg-fetch';\r\n\r\nimport base64 from 'keen-core/lib/utils/base64';\r\nimport each from 'keen-core/lib/utils/each';\r\nimport extend from 'keen-core/lib/utils/extend';\r\n\r\nimport Keen from './index';\r\nimport { getExtendedEventBody } from './extend-events';\r\nimport fetchRetry from './utils/fetchRetry';\r\nimport isUnique from './utils/unique';\r\n\r\n// ------------------------------\r\n// .recordEvent\r\n// ------------------------------\r\n\r\nexport function recordEvent(eventCollectionOrConfigObject, eventBody, callback){\r\n  let eventCollection = eventCollectionOrConfigObject;\r\n  let useBeaconApi = false;\r\n  let unique;\r\n  let configObject;\r\n  let clientConfig = this.config;\r\n\r\n  if (typeof eventCollectionOrConfigObject === 'object'\r\n    && eventCollectionOrConfigObject) {\r\n    // slowly but surely we migrate to one object with all args\r\n    configObject = eventCollectionOrConfigObject;\r\n    eventCollection = eventCollectionOrConfigObject.collection;\r\n    eventBody = eventCollectionOrConfigObject.event;\r\n    callback = eventCollectionOrConfigObject.callback;\r\n    unique = eventCollectionOrConfigObject.unique;\r\n  }\r\n\r\n  const url = this.url('events', encodeURIComponent(eventCollection));\r\n  let data = {};\r\n\r\n  if (!checkValidation.call(this, callback)) {\r\n    return;\r\n  }\r\n\r\n  if (!eventCollection || typeof eventCollection !== 'string') {\r\n    handleValidationError.call(this, 'Collection name must be a string.', callback);\r\n    return;\r\n  }\r\n\r\n  extend(data, eventBody);\r\n\r\n  // ------------------------------\r\n  // Run extendEvent(s) transforms\r\n  // ------------------------------\r\n  const extendedEventsHash = {};\r\n  getExtendedEventBody(extendedEventsHash, this.extensions.events);\r\n  getExtendedEventBody(extendedEventsHash, this.extensions.collections[eventCollection]);\r\n  getExtendedEventBody(extendedEventsHash, [data]);\r\n\r\n  if (unique) {\r\n    return isUnique(configObject, extendedEventsHash).then(isUniqueResult => {\r\n      if (!isUniqueResult) {\r\n        return Promise.resolve({\r\n          created: false,\r\n          message: '[NOT_UNIQUE] This event has already been recorded'\r\n        });\r\n      }\r\n      return recordEvent.call(this, { ...eventCollectionOrConfigObject, unique: undefined });\r\n    });\r\n  }\r\n\r\n  this.emit('recordEvent', eventCollection, extendedEventsHash);\r\n\r\n  if (!Keen.enabled) {\r\n    handleValidationError.call(this, 'Keen.enabled is set to false.', callback);\r\n    return false;\r\n  }\r\n\r\n  return send.call(this, { url, extendedEventsHash, callback, configObject, eventCollection });\r\n}\r\n\r\n// ------------------------------\r\n// .recordEvents\r\n// ------------------------------\r\n\r\nexport function recordEvents(eventsHash, callback){\r\n  const self = this;\r\n  const url = this.url('events');\r\n\r\n  if (!checkValidation.call(this, callback)) {\r\n    return;\r\n  }\r\n\r\n  if ('object' !== typeof eventsHash || eventsHash instanceof Array) {\r\n    handleValidationError.call(this, 'First argument must be an object', callback );\r\n    return;\r\n  }\r\n\r\n  if (arguments.length > 2) {\r\n    handleValidationError.call(this, 'Incorrect arguments provided to #recordEvents method', callback);\r\n    return;\r\n  }\r\n\r\n  // ------------------------------\r\n  // Run extendEvent(s) transforms\r\n  // ------------------------------\r\n  const extendedEventsHash = {};\r\n  each(eventsHash, function(eventList, eventCollection){\r\n    // Find or create collection on new hash\r\n    extendedEventsHash[eventCollection] = extendedEventsHash[eventCollection] || [];\r\n    // Loop over each eventBody in the existing hash\r\n    each(eventList, function(eventBody, index){\r\n      // Create a new data object\r\n      let extendedEventBody = {};\r\n      // Process \"events\" transform pipeline\r\n      getExtendedEventBody(extendedEventBody, self.extensions.events);\r\n      // Process \"collection\" transform pipeline\r\n      getExtendedEventBody(extendedEventBody, self.extensions.collections[eventCollection]);\r\n      // Blend existing eventBody data into the result\r\n      getExtendedEventBody(extendedEventBody, [eventBody]);\r\n      // Push extendedEventBody into new hash\r\n      extendedEventsHash[eventCollection].push(extendedEventBody);\r\n    });\r\n  });\r\n\r\n  this.emit('recordEvents', extendedEventsHash);\r\n\r\n  if (!Keen.enabled) {\r\n    handleValidationError.call(this, 'Keen.enabled is set to false.', callback);\r\n    return false;\r\n  }\r\n\r\n  return send.call(this, { url, extendedEventsHash, callback });\r\n}\r\n\r\nfunction send({ url, extendedEventsHash, callback, configObject = {}, eventCollection}){\r\n  const clientConfig = this.config;\r\n  const requestType = configObject.requestType // specific method for one request\r\n    || this.config.requestType; // global request type of client\r\n\r\n  if (\r\n    navigator && navigator.sendBeacon &&\r\n    (requestType === 'beaconAPI' || requestType === 'beacon')\r\n      // so you can send specific recordEvent() using beaconAPI\r\n      // even if your global client's config prefers Fetch\r\n  ) {\r\n    navigator.sendBeacon(\r\n      `${url}?api_key=${this.writeKey()}`,\r\n      JSON.stringify(extendedEventsHash)\r\n    );\r\n    if (callback) {\r\n      // Beacon API is not handling responses nor errors\r\n      callback();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  // this is IMAGE beacon, not the Beacon API. deprecated\r\n  if (requestType === 'beacon' || requestType === 'img') {\r\n    const getRequestUrl = this.url('events', encodeURIComponent(eventCollection), {\r\n      api_key  : this.writeKey(),\r\n      data     : encodeURIComponent( base64.encode( JSON.stringify(extendedEventsHash) ) ),\r\n      modified : new Date().getTime()\r\n    });\r\n    const getRequestUrlOkLength = getRequestUrl.length < getUrlMaxLength();\r\n\r\n    if (getRequestUrlOkLength) {\r\n      sendBeacon.call(this, getRequestUrl, callback);\r\n    }\r\n    else {\r\n      if (callback) {\r\n        callback('Beacon URL length exceeds current browser limit, and XHR is not supported.', null);\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  if (typeof fetch !== 'undefined') {\r\n    return sendFetch.call(this, 'POST', url, extendedEventsHash, callback);\r\n  }\r\n\r\n  return this;\r\n}\r\n\r\nfunction sendFetch(method, url, data, callback = undefined){\r\n  const self = this;\r\n\r\n  return fetchRetry(url, {\r\n      method,\r\n      body: data ? JSON.stringify(data) : '',\r\n      mode: 'cors',\r\n      redirect: 'follow',\r\n      referrerPolicy: self.referrerPolicy() || 'unsafe-url',\r\n      headers: {\r\n        'Authorization': self.writeKey(),\r\n        'Content-Type': 'application/json'\r\n      },\r\n      // keepalive: true, not supported for CORS yet\r\n      retry: self.config.retry\r\n    })\r\n    .catch(connectionError => {\r\n      if (typeof callback !== 'undefined') {\r\n        callback.call(self, connectionError, null);\r\n      }\r\n      self.emit('error', connectionError);\r\n      return Promise.reject(connectionError);\r\n    })\r\n    .then(response => {\r\n      if (response.ok) {\r\n        return response.json();\r\n      }\r\n\r\n      return response.json().then(responseJSON => {\r\n        return Promise.reject({\r\n          error_code: responseJSON.error_code,\r\n          body: responseJSON.message,\r\n          status: response.status,\r\n          ok: false,\r\n          statusText: response.statusText\r\n        });\r\n      });\r\n    }).then(responseJSON => {\r\n      const eventsSavedSuccessfuly = checkEventsSavedSuccessfuly(responseJSON);\r\n      if (eventsSavedSuccessfuly) {\r\n        if (typeof callback !== 'undefined') {\r\n          callback.call(self, null, responseJSON);\r\n        }\r\n        return Promise.resolve(responseJSON);\r\n      } else {\r\n        if (typeof callback !== 'undefined') {\r\n          callback.call(self, responseJSON, null);\r\n        }\r\n        self.emit('error', responseJSON);\r\n        return Promise.reject(responseJSON);\r\n      }\r\n    });\r\n}\r\n\r\nfunction checkEventsSavedSuccessfuly(response){\r\n  // single event\r\n  if (typeof response.created !== 'undefined') {\r\n    if (response.created) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n  // multiple events\r\n  const responseKeys = Object.keys(response);\r\n  const notSavedEvents = responseKeys\r\n    .map(collection => {\r\n      return response[collection].filter(event => !event.success);\r\n    })\r\n    .filter(collection => collection.length > 0);\r\n\r\n  if (notSavedEvents.length === 0) {\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n// Validation\r\nfunction checkValidation(callback){\r\n\r\n  if (!this.projectId()) {\r\n    handleValidationError.call(this, 'Keen.Client is missing a projectId property.', callback);\r\n    return false;\r\n  }\r\n  if (!this.writeKey()) {\r\n    handleValidationError.call(this, 'Keen.Client is missing a writeKey property.', callback);\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction handleValidationError(message, callback){\r\n  const err = `Event(s) not recorded: ${message}`;\r\n  this.emit('error', err);\r\n  if (callback) {\r\n    callback.call(this, err, null);\r\n  }\r\n}\r\n\r\nfunction getUrlMaxLength(){\r\n  if ('undefined' !== typeof window && navigator) {\r\n    if (navigator.userAgent.indexOf('MSIE') !== -1 || navigator.appVersion.indexOf('Trident/') > 0) {\r\n      return 1900;\r\n    }\r\n  }\r\n  return 16000;\r\n}\r\n\r\n/*\r\n  DEPRECATED METHODS\r\n*/\r\n\r\n// Image Beacon Requests\r\n// DEPRECATED\r\nfunction sendBeacon(url, callback){\r\n  var self = this,\r\n      img = document.createElement('img'),\r\n      loaded = false;\r\n\r\n  img.onload = function() {\r\n    loaded = true;\r\n    if ('naturalHeight' in this) {\r\n      if (this.naturalHeight + this.naturalWidth === 0) {\r\n        this.onerror();\r\n        return;\r\n      }\r\n    } else if (this.width + this.height === 0) {\r\n      this.onerror();\r\n      return;\r\n    }\r\n    if (callback) {\r\n      callback.call(self);\r\n    }\r\n  };\r\n  img.onerror = function() {\r\n    loaded = true;\r\n    if (callback) {\r\n      callback.call(self, 'An error occurred!', null);\r\n    }\r\n  };\r\n  img.src = url + '&c=clv1';\r\n}\r\n","import Keen from './index';\r\nimport each from 'keen-core/lib/utils/each';\r\nimport { queue } from './utils/queue';\r\n\r\nexport function deferEvent(eventCollection, eventBody){\r\n\r\n  if (arguments.length !== 2 || typeof eventCollection !== 'string') {\r\n    handleValidationError.call(this, 'Incorrect arguments provided to #deferEvent method');\r\n    return;\r\n  }\r\n\r\n  this.queue.events[eventCollection] = this.queue.events[eventCollection] || [];\r\n  this.queue.events[eventCollection].push(eventBody);\r\n  this.queue.capacity++;\r\n  if (!this.queue.timer) {\r\n    this.queue.start();\r\n  }\r\n  this.emit('deferEvent', eventCollection, eventBody);\r\n  return this;\r\n}\r\n\r\nexport function deferEvents(eventsHash){\r\n  var self = this;\r\n\r\n  if (arguments.length !== 1 || typeof eventsHash !== 'object') {\r\n    handleValidationError.call(this, 'Incorrect arguments provided to #deferEvents method');\r\n    return;\r\n  }\r\n\r\n  each(eventsHash, function(eventList, eventCollection){\r\n    self.queue.events[eventCollection] = self.queue.events[eventCollection] || [];\r\n    self.queue.events[eventCollection] = self.queue.events[eventCollection].concat(eventList);\r\n    self.queue.capacity = self.queue.capacity + eventList.length;\r\n    if (!self.queue.timer) {\r\n      self.queue.start();\r\n    }\r\n  });\r\n  self.emit('deferEvents', eventsHash);\r\n  return self;\r\n}\r\n\r\nexport function queueCapacity(num){\r\n  if (!arguments.length) return this.queue.config.capacity;\r\n  this.queue.config.capacity = num ? Number(num): 0;\r\n  this.queue.check();\r\n  return this;\r\n}\r\n\r\nexport function queueInterval(num){\r\n  if (!arguments.length) return this.queue.config.interval;\r\n  this.queue.config.interval = num ? Number(num): 0;\r\n  this.queue.check();\r\n  return this;\r\n}\r\n\r\nexport function recordDeferredEvents(){\r\n  const self = this;\r\n\r\n  if (self.queue.capacity > 0) {\r\n    self.queue.pause();\r\n    let clonedQueueConfig = { ...self.queue.config };\r\n    let clonedQueueEvents = { ...self.queue.events };\r\n    self.queue = queue();\r\n    self.queue.config = clonedQueueConfig;\r\n    self.queue.on('flush', function(){\r\n      self.recordDeferredEvents();\r\n    });\r\n    self.emit('recordDeferredEvents', clonedQueueEvents);\r\n    self.recordEvents(clonedQueueEvents, (err, res) => {\r\n      if (err) {\r\n        self.emit('recordDeferredEventsError', err, clonedQueueEvents);\r\n      }\r\n    });\r\n  }\r\n  return self;\r\n}\r\n\r\nexport function unloadDeferredEvents(){\r\n  self.queue.pause();\r\n  each(self.queue.events, function(events, collection){\r\n    self.recordEvent(collection, events);\r\n  });\r\n}\r\n\r\nfunction handleValidationError(message){\r\n  this.emit('error', `Event(s) not deferred: ${message}`);\r\n}\r\n","import pkg from '../package.json';\r\n\r\nexport function initAutoTrackingCore(lib) {\r\n  return function(obj = {}) {\r\n    const client = this;\r\n    const helpers = lib.helpers;\r\n    const utils = lib.utils;\r\n\r\n    const options = utils.extend({\r\n      ignoreDisabledFormFields: false,\r\n      ignoreFormFieldTypes: ['password'],\r\n      recordClicks: true,\r\n      recordFormSubmits: true,\r\n      recordInputChanges: false,\r\n      recordPageUnloads: false,\r\n      recordPageViews: true,\r\n      recordPageViewsOnExit: false,\r\n      recordScrollState: true,\r\n      shareUuidAcrossDomains: false,\r\n      collectIpAddress: true,\r\n      collectUuid: true,\r\n      catchError: undefined // optional, function(someError) - error handler\r\n    }, obj);\r\n\r\n    const defaultDomElementOptions = {\r\n      recordTextContent: true,\r\n      redactTextContent: true\r\n    }\r\n\r\n    options.domElementOptions = utils.extend(defaultDomElementOptions, obj.domElementOptions);\r\n\r\n    if (client.config.requestType === 'beaconAPI' && options.catchError) {\r\n      throw `You cannot use the BeaconAPI and catchError function in the same time, because BeaconAPI ignores errors. For requests with error handling - use requestType: 'fetch'`;\r\n      return;\r\n    }\r\n\r\n    if (\r\n      client.config.requestType === 'jsonp' // jsonp is deprecated, it's the default value from old keen's client\r\n    ) {\r\n      if (options.catchError) {\r\n        client.config.requestType = 'fetch';\r\n      } else {\r\n        client.config.requestType = 'beaconAPI';\r\n      }\r\n    }\r\n\r\n    const session_cookie = new utils.cookie('prodperfect_session');\r\n    let session_uuid = session_cookie.get('session_uuid');\r\n    if (!session_uuid) {\r\n      session_uuid = helpers.getUniqueId();\r\n    }\r\n    session_cookie.set('session_uuid', session_uuid);\r\n    session_cookie.expire(1/48);\r\n\r\n    const prodperfectTestData = new utils.cookie('prodperfect_test').get('test_run_data');\r\n\r\n    const now = new Date();\r\n    const cookie = new utils.cookie('keen');\r\n\r\n    const domainName = helpers.getDomainName(window.location.hostname);\r\n    const cookieDomain = domainName && options.shareUuidAcrossDomains ? {\r\n      domain: '.' + domainName\r\n    } : {};\r\n\r\n    let uuid;\r\n    if (options.collectUuid) {\r\n      uuid = cookie.get('uuid');\r\n      if (!uuid) {\r\n        uuid = helpers.getUniqueId();\r\n        cookie.set('uuid', uuid, cookieDomain);\r\n      }\r\n    }\r\n\r\n    let initialReferrer = cookie.get('initialReferrer');\r\n    if (!initialReferrer){\r\n      initialReferrer = document && document.referrer || undefined;\r\n      cookie.set('initialReferrer', initialReferrer, cookieDomain);\r\n    }\r\n\r\n    let scrollState = {};\r\n    if (options.recordScrollState) {\r\n      scrollState = helpers.getScrollState();\r\n      utils.listener('window').on('scroll', () => {\r\n        scrollState = helpers.getScrollState(scrollState);\r\n      });\r\n    }\r\n\r\n    const tracker_loaded_at_time = now.toISOString();\r\n    const tracker_load_uuid_value = helpers.getUniqueId();\r\n\r\n    const addons = [\r\n      {\r\n        name: 'keen:ua_parser',\r\n        input: {\r\n          ua_string: 'user_agent'\r\n        },\r\n        output: 'tech'\r\n      },\r\n      {\r\n        name: 'keen:url_parser',\r\n        input: {\r\n          url: 'url.full'\r\n        },\r\n        output: 'url.info'\r\n      },\r\n      {\r\n        name: 'keen:url_parser',\r\n        input: {\r\n          url: 'referrer.full'\r\n        },\r\n        output: 'referrer.info'\r\n      },\r\n      {\r\n        name: 'keen:date_time_parser',\r\n        input: {\r\n          date_time: 'keen.timestamp'\r\n        },\r\n        output: 'time.utc'\r\n      },\r\n      {\r\n        name: 'keen:date_time_parser',\r\n        input: {\r\n          date_time: 'local_time_full'\r\n        },\r\n        output: 'time.local'\r\n      }\r\n    ];\r\n\r\n    let ip_address = '${keen.ip}';\r\n    addons.push({\r\n      name: 'keen:ip_to_geo',\r\n      input: {\r\n        ip: 'ip_address',\r\n        remove_ip_property: !options.collectIpAddress\r\n      },\r\n      output : 'geo'\r\n    });\r\n\r\n    client.extendEvents(function() {\r\n      const browserProfile = helpers.getBrowserProfile();\r\n      return {\r\n        event_uuid:  helpers.getUniqueId(),\r\n        iso_time_full: new Date().toISOString(),\r\n        local_time_full: new Date().toString(),\r\n        session: {\r\n          session_uuid: session_uuid\r\n        },\r\n        tracked_by: pkg.name + '-' + pkg.version,\r\n        tracker_load_uuid: tracker_load_uuid_value,\r\n        tracker_loaded_at: tracker_loaded_at_time,\r\n        prodperfect_test_data: prodperfectTestData,\r\n        user: {\r\n          uuid\r\n        },\r\n        page: {\r\n          title: document ? document.title : null,\r\n          description: browserProfile.description,\r\n          scroll_state: scrollState,\r\n          time_on_page: getSecondsSinceDate(now),\r\n          time_on_page_ms: getMiliSecondsSinceDate(now)\r\n        },\r\n\r\n        ip_address,\r\n        geo: { /* Enriched */ },\r\n\r\n        user_agent: '${keen.user_agent}',\r\n        tech: {\r\n          profile: browserProfile\r\n          /* Enriched */\r\n        },\r\n\r\n        url: {\r\n          full: window ? window.location.href : '',\r\n          info: { /* Enriched */ }\r\n        },\r\n\r\n        referrer: {\r\n          initial: initialReferrer,\r\n          full: document ? document.referrer : '',\r\n          info: { /* Enriched */ }\r\n        },\r\n\r\n        time: {\r\n          local: { /* Enriched */ },\r\n          utc: { /* Enriched */ }\r\n        },\r\n\r\n        keen: {\r\n          timestamp: new Date().toISOString(),\r\n          addons,\r\n        }\r\n      };\r\n    });\r\n\r\n    if (options.recordClicks === true) {\r\n      utils.listener('*').on('click', function(e) {\r\n        const el = e.target;\r\n        const event = {\r\n          element: helpers.getDomNodeProfile(el, options.domElementOptions)\r\n        };\r\n\r\n        if (options.catchError) {\r\n          return client\r\n            .recordEvent({\r\n              collection: 'clicks',\r\n              event\r\n            }).catch(err => {\r\n              options.catchError(err);\r\n            });\r\n        }\r\n\r\n        return client\r\n          .recordEvent({\r\n            collection: 'clicks',\r\n            event\r\n          });\r\n      });\r\n    }\r\n\r\n    if (options.recordFormSubmits === true) {\r\n      utils.listener('form').on('submit', function(e) {\r\n        const el = e.target;\r\n        const serializerOptions = {\r\n          disabled: options.ignoreDisabledFormFields,\r\n          ignoreTypes: options.ignoreFormFieldTypes\r\n        };\r\n        const fields = utils.serializeForm(el, serializerOptions);\r\n        const keys = Object.keys(fields);\r\n        for (let x = 0; x < keys.length; x++) {\r\n          fields[keys[x]] = '---REDACTED---';\r\n        }\r\n        const event = {\r\n          form: {\r\n            action: el.action,\r\n            fields: fields,\r\n            method: el.method\r\n          },\r\n          element: helpers.getDomNodeProfile(el, options.domElementOptions)\r\n        };\r\n\r\n        if (options.catchError) {\r\n          return client\r\n            .recordEvent({\r\n              collection: 'form_submissions',\r\n              event\r\n            })\r\n            .catch(err => {\r\n              options.catchError(err);\r\n            });\r\n        }\r\n\r\n        return client.recordEvent({\r\n          collection: 'form_submissions',\r\n          event\r\n        });\r\n      });\r\n    }\r\n\r\n    if (options.recordInputChanges === true) {\r\n      utils.listener('*').on('change', function (e) {\r\n        var el = e.target;\r\n        var props = {\r\n          element: helpers.getDomNodeProfile(el, options.domElementOptions),\r\n          page: {\r\n            scroll_state: helpers.getScrollState\r\n          }\r\n        };\r\n        client.recordEvent('changes', props);\r\n      });\r\n    }\r\n\r\n    if (options.recordPageUnloads === true && window.addEventListener) {\r\n      window.addEventListener('beforeunload', function (e) {\r\n        client.recordEvent('pageunloads');\r\n      }, false);\r\n    }\r\n\r\n    if (options.recordPageViews === true && !options.recordPageViewsOnExit) {\r\n      if (options.catchError) {\r\n        client\r\n          .recordEvent({\r\n            collection: 'pageviews'\r\n          })\r\n          .catch(err => {\r\n            options.catchError(err);\r\n          });\r\n      } else {\r\n        client\r\n          .recordEvent({\r\n            collection: 'pageviews'\r\n          });\r\n      }\r\n    }\r\n\r\n    if (options.recordPageViewsOnExit && typeof window !== 'undefined') {\r\n      window.addEventListener('beforeunload', () => {\r\n        client.config.requestType = 'beaconAPI'; // you can run beforeunload only with beaconAPI\r\n        client.recordEvent({\r\n          collection: 'pageviews'\r\n        });\r\n      });\r\n    }\r\n\r\n    return client;\r\n  };\r\n}\r\n\r\nfunction getSecondsSinceDate(date) {\r\n  return Math.round(getMiliSecondsSinceDate(date) / 1000);\r\n}\r\n\r\nfunction getMiliSecondsSinceDate(date) {\r\n  return new Date().getTime() - date.getTime();\r\n}\r\n","export function getScreenProfile(){\r\n  var keys, output;\r\n\r\n  if ('undefined' == typeof window || !window.screen) return {};\r\n\r\n  keys = ['height', 'width', 'colorDepth', 'pixelDepth', 'availHeight', 'availWidth'];\r\n  output = {};\r\n\r\n  for (var i = 0; i < keys.length; i++) {\r\n    output[keys[i]] = window.screen[keys[i]] ? window.screen[keys[i]] : null;\r\n  }\r\n\r\n  output.orientation = {\r\n    'angle' : window.screen.orientation ? window.screen.orientation['angle'] : 0,\r\n    'type'  : window.innerWidth > window.innerHeight ? 'landscape': 'portrait'\r\n  };\r\n\r\n  return output;\r\n}\r\n","export function getWindowProfile(){\r\n  var body, html, output;\r\n\r\n  if ('undefined' == typeof document) return {};\r\n\r\n  body = document.body;\r\n  html = document.documentElement;\r\n\r\n  output = {\r\n    'height': ('innerHeight' in window) ? window.innerHeight : document.documentElement.offsetHeight,\r\n    'width': ('innerWidth' in window) ? window.innerWidth : document.documentElement.offsetWidth,\r\n    'scrollHeight': Math.max( body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight ) || null\r\n  };\r\n\r\n  if (window.screen) {\r\n    output.ratio = {\r\n      'height': (window.screen.availHeight) ? parseFloat( (window.innerHeight/window.screen.availHeight).toFixed(2) ) : null,\r\n      'width': (window.screen.availWidth) ? parseFloat( (window.innerWidth/window.screen.availWidth).toFixed(2) ) : null\r\n    };\r\n  }\r\n\r\n  return output;\r\n}\r\n\r\n/*\r\n  Notes:\r\n    document.documentElement.offsetHeight/Width is a workaround for IE8 and below, where window.innerHeight/Width is undefined\r\n*/\r\n","import { getScreenProfile } from './getScreenProfile';\r\nimport { getWindowProfile } from './getWindowProfile';\r\n\r\nexport function getBrowserProfile() {\r\n  return {\r\n    'cookies'    : ('undefined' !== typeof navigator.cookieEnabled) ? navigator.cookieEnabled : false,\r\n    'codeName'   : navigator.appCodeName,\r\n    'description': getDocumentDescription(),\r\n    'language'   : navigator.language,\r\n    'name'       : navigator.appName,\r\n    'online'     : navigator.onLine,\r\n    'platform'   : navigator.platform,\r\n    'useragent'  : navigator.userAgent,\r\n    'version'    : navigator.appVersion,\r\n    'screen'     : getScreenProfile(),\r\n    'window'     : getWindowProfile()\r\n  }\r\n}\r\n\r\nfunction getDocumentDescription() {\r\n  var el;\r\n  if (document && typeof document.querySelector === 'function') {\r\n    el = document.querySelector('meta[name=\"description\"]');\r\n  }\r\n  return el ? el.content : '';\r\n}\r\n","export function getDatetimeIndex(input){\r\n  var date = input || new Date();\r\n  return {\r\n    'hour_of_day'  : date.getHours(),\r\n    'day_of_week'  : parseInt( 1 + date.getDay() ),\r\n    'day_of_month' : date.getDate(),\r\n    'month'        : parseInt( 1 + date.getMonth() ),\r\n    'year'         : date.getFullYear()\r\n  };\r\n}\r\n","function extractHostname(url) {\r\n    var hostname;\r\n    //find & remove protocol (http, ftp, etc.) and get hostname\r\n\r\n    if (url.indexOf(\"://\") > -1) {\r\n        hostname = url.split('/')[2];\r\n    }\r\n    else {\r\n        hostname = url.split('/')[0];\r\n    }\r\n\r\n    //find & remove port number\r\n    hostname = hostname.split(':')[0];\r\n    //find & remove \"?\"\r\n    hostname = hostname.split('?')[0];\r\n\r\n    return hostname;\r\n}\r\n\r\n// To address those who want the \"root domain,\" use this function:\r\nexport function getDomainName(url) {\r\n    var domain = extractHostname(url),\r\n        splitArr = domain.split('.'),\r\n        arrLen = splitArr.length;\r\n\r\n    //extracting the root domain here\r\n    //if there is a subdomain\r\n    if (arrLen > 2) {\r\n        domain = splitArr[arrLen - 2] + '.' + splitArr[arrLen - 1];\r\n        //check to see if it's using a Country Code Top Level Domain (ccTLD) (i.e. \".me.uk\")\r\n        if (splitArr[arrLen - 2].length == 2 && splitArr[arrLen - 1].length == 2) {\r\n            //this is using a ccTLD\r\n            domain = splitArr[arrLen - 3] + '.' + domain;\r\n        }\r\n    }\r\n    return domain;\r\n}\r\n","export function getDomNodePath(el){\r\n  if (!el.nodeName) return '';\r\n\r\n  var stack = [];\r\n  while ( el.parentNode != null ) {\r\n    // console.log(el.nodeName);\r\n    var sibCount = 0;\r\n    var sibIndex = 0;\r\n    for ( var i = 0; i < el.parentNode.childNodes.length; i++ ) {\r\n      var sib = el.parentNode.childNodes[i];\r\n      if ( sib.nodeName == el.nodeName ) {\r\n        if ( sib === el ) {\r\n          sibIndex = sibCount;\r\n        }\r\n        sibCount++;\r\n      }\r\n    }\r\n    if ( el.hasAttribute('id') && el.id != '' ) {\r\n      stack.unshift(el.nodeName.toLowerCase() + '#' + el.id);\r\n    } else if ( sibCount > 1 ) {\r\n      stack.unshift(el.nodeName.toLowerCase() + ':eq(' + sibIndex + ')');\r\n    } else {\r\n      stack.unshift(el.nodeName.toLowerCase());\r\n    }\r\n    el = el.parentNode;\r\n  }\r\n\r\n  return stack.slice(1).join(' > ');\r\n}\r\n\r\n\r\n// via: http://stackoverflow.com/a/16742828/2511985\r\n","export function getDomNodeAttributes(el, filter) {\r\n  let i,\r\n    attributeNodes = el.attributes || {},\r\n    length = attributeNodes.length,\r\n    attrs = {};\r\n\r\n  for ( i = 0; i < length; i++ ){\r\n    const node = attributeNodes[i];\r\n\r\n    if(filter == '' || filter.test(node.name)) {\r\n     attrs[node.name] = node.value;\r\n    }\r\n  }\r\n\r\n  return attrs;\r\n}\r\n","import { getDomNodeAttributes } from './getDomNodeAttributes';\r\n\r\nconst EXCLUDE_VALUE_REGEX = /^((?!value).)*$/;\r\n\r\nexport function getBasicDomNodeProfile(el) {\r\n\r\n  return {\r\n    class: el.className,\r\n    href: el.href || null,\r\n    id: el.id,\r\n    name: el.name,\r\n    all_attrs:  getDomNodeAttributes(el, EXCLUDE_VALUE_REGEX),\r\n    node_name: el.nodeName,\r\n    tag_name: el.tagName,\r\n    text: el.text,\r\n    title: el.title,\r\n    type: el.type\r\n  };\r\n}\r\n","import { getBasicDomNodeProfile } from './getBasicDomNodeProfile';\r\n\r\nexport function getNParents(element, nParents = 5, parents = []) {\r\n  let parent = element.parentNode;\r\n\r\n  if (nParents === 0 || !parent) {\r\n    return parents;\r\n  }\r\n\r\n  return getNParents(\r\n    parent,\r\n    nParents - 1,\r\n    parents.concat({\r\n      ...getBasicDomNodeProfile(parent),\r\n      nth_parent: parents.length + 1\r\n    })\r\n  )\r\n}\r\n","import { getDomNodePath } from './getDomNodePath';\r\nimport { getBasicDomNodeProfile } from './getBasicDomNodeProfile';\r\nimport { getNParents } from './getNParents';\r\n\r\nconst getTextContent = (el, options) => {\r\n  if(!options.recordTextContent || !el.textContent) {\r\n    return null;\r\n  }\r\n\r\n  if(options.redactTextContent) {\r\n    return '---REDACTED---';\r\n  }\r\n\r\n  return el.textContent;\r\n}\r\n\r\nexport function getDomNodeProfile(el, options = {}) {\r\n  return {\r\n    ...getBasicDomNodeProfile(el),\r\n    action: el.action,\r\n    method: el.method,\r\n    n_parents: getNParents(el, options.nParents),\r\n    selector: getDomNodePath(el),\r\n    text_content: getTextContent(el, options),\r\n    x_position: el.offsetLeft || el.clientLeft || null,\r\n    y_position: el.offsetTop || el.clientTop || null\r\n  };\r\n}\r\n","import extend from 'keen-core/lib/utils/extend';\r\n\r\nexport function getScrollState(obj){\r\n  var config = typeof obj === 'object' ? obj : {};\r\n  var state = extend({\r\n    pixel: 0,\r\n    pixel_max: 0,\r\n    ratio: null,\r\n    ratio_max: null\r\n  }, config);\r\n\r\n  if (typeof window !== undefined || typeof document !== undefined) {\r\n    state.pixel = getScrollOffset() + getWindowHeight();\r\n    if (state.pixel > state.pixel_max) {\r\n      state.pixel_max = state.pixel;\r\n    }\r\n    state.ratio = parseFloat(Number(state.pixel / getScrollableArea()).toFixed(2));\r\n    state.ratio_max = parseFloat(Number(state.pixel_max / getScrollableArea()).toFixed(2));\r\n  }\r\n\r\n  return state;\r\n}\r\n\r\nfunction getScrollableArea() {\r\n  var body = document.body;\r\n  var html = document.documentElement;\r\n  return Math.max( body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight ) || null;\r\n}\r\n\r\nfunction getScrollOffset() {\r\n  return (window.pageYOffset !== undefined) ? window.pageYOffset : (document.documentElement || document.body.parentNode || document.body).scrollTop;\r\n}\r\n\r\nfunction getWindowHeight() {\r\n  return window.innerHeight || document.documentElement.clientHeight;\r\n}\r\n","export function getUniqueId() {\r\n  // uuidv4\r\n  if (typeof crypto !== 'undefined' && crypto.getRandomValues) {\r\n    // browser\r\n    return ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>\r\n      (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)\r\n    )\r\n  } else {\r\n    // node & older browsers\r\n    let str = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx';\r\n    return str.replace(/[xy]/g, function(c) {\r\n      let r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);\r\n      return v.toString(16);\r\n    });\r\n  }\r\n}\r\n","import Cookies from 'js-cookie';\r\nimport extend from 'keen-core/lib/utils/extend';\r\n\r\nexport const cookie = function(str){\r\n  if (!arguments.length) return;\r\n  if (this instanceof cookie === false) {\r\n    return new cookie(str);\r\n  }\r\n\r\n  this.config = {\r\n    key: str,\r\n    options: {\r\n      expires: 365\r\n    }\r\n  };\r\n  this.data = this.get();\r\n  return this;\r\n}\r\n\r\ncookie.prototype.get = function(str){\r\n  var data = {};\r\n\r\n  if (Cookies.get(this.config.key)) {\r\n    data = Cookies.getJSON(this.config.key);\r\n  }\r\n  if (str && typeof data === 'object' && typeof data !== null) {\r\n    return (typeof data[str] !== 'undefined') ? data[str] : null;\r\n  }\r\n  else {\r\n    return data;\r\n  }\r\n};\r\n\r\ncookie.prototype.set = function(str, value, options){\r\n  if (!arguments.length || !this.enabled()) return this;\r\n  if (typeof str === 'string' && arguments.length >= 2) {\r\n    this.data[str] = value ? value : null;\r\n  }\r\n  else if (typeof str === 'object' && arguments.length === 1) {\r\n    extend(this.data, str);\r\n  }\r\n  Cookies.set(\r\n    this.config.key,\r\n    this.data,\r\n    extend(this.config.options, options || {})\r\n  );\r\n  return this;\r\n};\r\n\r\ncookie.prototype.expire = function(daysUntilExpire){\r\n  if (daysUntilExpire) {\r\n    Cookies.set(\r\n      this.config.key,\r\n      this.data,\r\n      extend(this.config.options, { expires: daysUntilExpire })\r\n    );\r\n  } else {\r\n    Cookies.remove(this.config.key);\r\n    this.data = {};\r\n  }\r\n  return this;\r\n};\r\n\r\ncookie.prototype.options = function(obj){\r\n  if (!arguments.length) return this.config.options;\r\n  this.config.options = (typeof obj === 'object') ? obj : {};\r\n  return this;\r\n};\r\n\r\ncookie.prototype.enabled = function(){\r\n  return navigator.cookieEnabled;\r\n};\r\n","/*\r\n  This is a modified copy of https://github.com/defunctzombie/form-serialize/ v0.7.1\r\n  Includes a new configuration option:\r\n    * ignoreTypes - Array, Default: [], Example: [ 'password' ]\r\n*/\r\n\r\n// types which indicate a submit action and are not successful controls\r\n// these will be ignored\r\nvar k_r_submitter = /^(?:submit|button|image|reset|file)$/i;\r\n\r\n// node names which could be successful controls\r\nvar k_r_success_contrls = /^(?:input|select|textarea|keygen)/i;\r\n\r\n// Matches bracket notation.\r\nvar brackets = /(\\[[^\\[\\]]*\\])/g;\r\n\r\n// serializes form fields\r\n// @param form MUST be an HTMLForm element\r\n// @param options is an optional argument to configure the serialization. Default output\r\n// with no options specified is a url encoded string\r\n//    - hash: [true | false] Configure the output type. If true, the output will\r\n//    be a js object.\r\n//    - serializer: [function] Optional serializer function to override the default one.\r\n//    The function takes 3 arguments (result, key, value) and should return new result\r\n//    hash and url encoded str serializers are provided with this module\r\n//    - disabled: [true | false]. If true serialize disabled fields.\r\n//    - empty: [true | false]. If true serialize empty fields\r\nexport function serializeForm(form, options) {\r\n  if (typeof options != 'object') {\r\n    options = { hash: !!options };\r\n  }\r\n  else if (options.hash === undefined) {\r\n    options.hash = true;\r\n  }\r\n\r\n  var result = (options.hash) ? {} : '';\r\n  var serializer = options.serializer || ((options.hash) ? hash_serializer : str_serialize);\r\n\r\n  var elements = form && form.elements ? form.elements : [];\r\n\r\n  // Object store each radio and set if it's empty or not\r\n  var radio_store = Object.create(null);\r\n\r\n  for (var i=0 ; i<elements.length ; ++i) {\r\n    var element = elements[i];\r\n\r\n    // NEW: Skip ignored field types\r\n    if (options.ignoreTypes && options.ignoreTypes.indexOf(element.type) > -1) {\r\n      continue;\r\n    }\r\n    // ingore disabled fields\r\n    if ((!options.disabled && element.disabled) || !element.name) {\r\n      continue;\r\n    }\r\n    // ignore anyhting that is not considered a success field\r\n    if (!k_r_success_contrls.test(element.nodeName) ||\r\n      k_r_submitter.test(element.type)) {\r\n      continue;\r\n    }\r\n\r\n    var key = element.name;\r\n    var val = element.value;\r\n\r\n    // we can't just use element.value for checkboxes cause some browsers lie to us\r\n    // they say \"on\" for value when the box isn't checked\r\n    if ((element.type === 'checkbox' || element.type === 'radio') && !element.checked) {\r\n      val = undefined;\r\n    }\r\n\r\n    // If we want empty elements\r\n    if (options.empty) {\r\n      if (element.type === 'checkbox' && !element.checked) {\r\n        val = '';\r\n      }\r\n\r\n      // for radio\r\n      if (element.type === 'radio') {\r\n        if (!radio_store[element.name] && !element.checked) {\r\n          radio_store[element.name] = false;\r\n        }\r\n        else if (element.checked) {\r\n          radio_store[element.name] = true;\r\n        }\r\n      }\r\n\r\n      // if options empty is true, continue only if its radio\r\n      if (val == undefined && element.type == 'radio') {\r\n        continue;\r\n      }\r\n    }\r\n    else {\r\n      // value-less fields are ignored unless options.empty is true\r\n      if (!val) {\r\n        continue;\r\n      }\r\n    }\r\n\r\n    // multi select boxes\r\n    if (element.type === 'select-multiple') {\r\n      val = [];\r\n\r\n      var selectOptions = element.options;\r\n      var isSelectedOptions = false;\r\n      for (var j=0 ; j<selectOptions.length ; ++j) {\r\n        var option = selectOptions[j];\r\n        var allowedEmpty = options.empty && !option.value;\r\n        var hasValue = (option.value || allowedEmpty);\r\n        if (option.selected && hasValue) {\r\n          isSelectedOptions = true;\r\n\r\n          // If using a hash serializer be sure to add the\r\n          // correct notation for an array in the multi-select\r\n          // context. Here the name attribute on the select element\r\n          // might be missing the trailing bracket pair. Both names\r\n          // \"foo\" and \"foo[]\" should be arrays.\r\n          if (options.hash && key.slice(key.length - 2) !== '[]') {\r\n            result = serializer(result, key + '[]', option.value);\r\n          }\r\n          else {\r\n            result = serializer(result, key, option.value);\r\n          }\r\n        }\r\n      }\r\n\r\n      if (!isSelectedOptions && options.empty) {\r\n        result = serializer(result, key, '');\r\n      }\r\n      continue;\r\n    }\r\n\r\n    result = serializer(result, key, val);\r\n  }\r\n\r\n  if (options.empty) {\r\n    for (var key in radio_store) {\r\n      if (!radio_store[key]) {\r\n        result = serializer(result, key, '');\r\n      }\r\n    }\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nfunction parse_keys(string) {\r\n  var keys = [];\r\n  var prefix = /^([^\\[\\]]*)/;\r\n  var children = new RegExp(brackets);\r\n  var match = prefix.exec(string);\r\n\r\n  if (match[1]) {\r\n      keys.push(match[1]);\r\n  }\r\n\r\n  while ((match = children.exec(string)) !== null) {\r\n      keys.push(match[1]);\r\n  }\r\n\r\n  return keys;\r\n}\r\n\r\nfunction hash_assign(result, keys, value) {\r\n  if (keys.length === 0) {\r\n    result = value;\r\n    return result;\r\n  }\r\n\r\n  var key = keys.shift();\r\n  var between = key.match(/^\\[(.+?)\\]$/);\r\n\r\n  if (key === '[]') {\r\n    result = result || [];\r\n\r\n    if (Array.isArray(result)) {\r\n      result.push(hash_assign(null, keys, value));\r\n    }\r\n    else {\r\n      // This might be the result of bad name attributes like \"[][foo]\",\r\n      // in this case the original `result` object will already be\r\n      // assigned to an object literal. Rather than coerce the object to\r\n      // an array, or cause an exception the attribute \"_values\" is\r\n      // assigned as an array.\r\n      result._values = result._values || [];\r\n      result._values.push(hash_assign(null, keys, value));\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  // Key is an attribute name and can be assigned directly.\r\n  if (!between) {\r\n    result[key] = hash_assign(result[key], keys, value);\r\n  }\r\n  else {\r\n    var string = between[1];\r\n    // +var converts the variable into a number\r\n    // better than parseInt because it doesn't truncate away trailing\r\n    // letters and actually fails if whole thing is not a number\r\n    var index = +string;\r\n\r\n    // If the characters between the brackets is not a number it is an\r\n    // attribute name and can be assigned directly.\r\n    if (isNaN(index)) {\r\n      result = result || {};\r\n      result[string] = hash_assign(result[string], keys, value);\r\n    }\r\n    else {\r\n      result = result || [];\r\n      result[index] = hash_assign(result[index], keys, value);\r\n    }\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\n// Object/hash encoding serializer.\r\nfunction hash_serializer(result, key, value) {\r\n  var matches = key.match(brackets);\r\n\r\n  // Has brackets? Use the recursive assignment function to walk the keys,\r\n  // construct any missing objects in the result tree and make the assignment\r\n  // at the end of the chain.\r\n  if (matches) {\r\n    var keys = parse_keys(key);\r\n    hash_assign(result, keys, value);\r\n  }\r\n  else {\r\n    // Non bracket notation can make assignments directly.\r\n    var existing = result[key];\r\n\r\n    // If the value has been assigned already (for instance when a radio and\r\n    // a checkbox have the same name attribute) convert the previous value\r\n    // into an array before pushing into it.\r\n    //\r\n    // NOTE: If this requirement were removed all hash creation and\r\n    // assignment could go through `hash_assign`.\r\n    if (existing) {\r\n      if (!Array.isArray(existing)) {\r\n        result[key] = [ existing ];\r\n      }\r\n\r\n      result[key].push(value);\r\n    }\r\n    else {\r\n      result[key] = value;\r\n    }\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\n// urlform encoding serializer\r\nfunction str_serialize(result, key, value) {\r\n  // encode newlines as \\r\\n cause the html spec says so\r\n  value = value.replace(/(\\r)?\\n/g, '\\r\\n');\r\n  value = encodeURIComponent(value);\r\n\r\n  // spaces should be '+' rather than '%20'.\r\n  value = value.replace(/%20/g, '+');\r\n  return result + (result ? '&' : '') + encodeURIComponent(key) + '=' + value;\r\n}\r\n","export function timer(num){\r\n  if (this instanceof timer === false) {\r\n    return new timer(num);\r\n  }\r\n  this.count = num || 0;\r\n  return this;\r\n}\r\n\r\ntimer.prototype.start = function(){\r\n  var self = this;\r\n  this.pause();\r\n  this.interval = setInterval(function(){\r\n    self.count++;\r\n  }, 1000);\r\n  return this;\r\n};\r\n\r\ntimer.prototype.pause = function(){\r\n  clearInterval(this.interval);\r\n  return this;\r\n};\r\n\r\ntimer.prototype.value = function(){\r\n  return this.count;\r\n};\r\n\r\ntimer.prototype.clear = function(){\r\n  this.count = 0;\r\n  return this;\r\n};\r\n","import KeenCore from './index';\r\nimport each from 'keen-core/lib/utils/each';\r\nimport extend from 'keen-core/lib/utils/extend';\r\nimport { listenerCore } from './utils/listener';\r\nimport {\r\n  recordEvent,\r\n  recordEvents\r\n} from './record-events-browser';\r\nimport {\r\n  deferEvent,\r\n  deferEvents,\r\n  queueCapacity,\r\n  queueInterval,\r\n  recordDeferredEvents\r\n} from './defer-events';\r\nimport { extendEvent, extendEvents } from './extend-events';\r\nimport { initAutoTrackingCore } from './browser-auto-tracking';\r\nimport { getBrowserProfile } from './helpers/getBrowserProfile';\r\nimport { getDatetimeIndex } from './helpers/getDatetimeIndex';\r\nimport { getDomainName } from './helpers/getDomainName';\r\nimport { getDomNodePath } from './helpers/getDomNodePath';\r\nimport { getDomNodeProfile } from './helpers/getDomNodeProfile';\r\nimport { getScreenProfile } from './helpers/getScreenProfile';\r\nimport { getScrollState } from './helpers/getScrollState';\r\nimport { getUniqueId } from './helpers/getUniqueId';\r\nimport { getWindowProfile } from './helpers/getWindowProfile';\r\nimport { cookie } from './utils/cookie';\r\nimport { deepExtend } from './utils/deepExtend';\r\nimport { serializeForm } from './utils/serializeForm';\r\nimport { timer } from './utils/timer';\r\n\r\n// ------------------------\r\n// Methods\r\n// ------------------------\r\nextend(KeenCore.prototype, {\r\n  recordEvent,\r\n  recordEvents\r\n});\r\n\r\nextend(KeenCore.prototype, {\r\n  deferEvent,\r\n  deferEvents,\r\n  queueCapacity,\r\n  queueInterval,\r\n  recordDeferredEvents\r\n});\r\nextend(KeenCore.prototype, {\r\n  extendEvent,\r\n  extendEvents\r\n});\r\n\r\n// ------------------------\r\n// Auto-Tracking\r\n// ------------------------\r\nconst initAutoTracking = initAutoTrackingCore(KeenCore);\r\nextend(KeenCore.prototype, {\r\n  initAutoTracking\r\n});\r\n\r\n// ------------------------\r\n// Helpers\r\n// ------------------------\r\nextend(KeenCore.helpers, {\r\n  getBrowserProfile,\r\n  getDatetimeIndex,\r\n  getDomainName,\r\n  getDomNodePath,\r\n  getDomNodeProfile,\r\n  getScreenProfile,\r\n  getScrollState,\r\n  getUniqueId,\r\n  getWindowProfile\r\n});\r\n\r\n// ------------------------\r\n// Utils\r\n// ------------------------\r\nconst listener = listenerCore(KeenCore);\r\nextend(KeenCore.utils, {\r\n  cookie,\r\n  deepExtend,\r\n  listener,\r\n  serializeForm,\r\n  timer\r\n});\r\n\r\nKeenCore.listenTo = (listenerHash) => {\r\n  each(listenerHash, (callback, key) => {\r\n    let split = key.split(' ');\r\n    let eventType = split[0],\r\n    selector = split.slice(1, split.length).join(' ');\r\n    // Create an unassigned listener\r\n    return listener(selector).on(eventType, callback);\r\n  });\r\n};\r\n\r\nexport let keenGlobals = undefined;\r\nif (typeof webpackKeenGlobals !== 'undefined') {\r\n  keenGlobals = webpackKeenGlobals;\r\n}\r\n\r\nexport const Keen = KeenCore.extendLibrary(KeenCore); // deprecated, left for backward compatibility\r\nexport const KeenTracking = Keen;\r\nexport default Keen;\r\n"],"sourceRoot":""}